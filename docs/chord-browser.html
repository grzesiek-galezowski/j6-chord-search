<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>J-6 Chord Browser (Web)</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #0f172a;
      --panel: #111827;
      --accent: #38bdf8;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --border: #1f2937;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, Segoe UI, sans-serif;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }

    header {
      padding: 24px;
      background: linear-gradient(135deg, #0b1222, #0f172a 45%, #0b1326);
      border-bottom: 1px solid var(--border);
    }

    header h1 {
      margin: 0 0 8px 0;
      font-size: 24px;
      letter-spacing: 0.5px;
    }

    header p {
      margin: 0;
      color: var(--muted);
    }

    .container {
      padding: 20px 24px 48px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 16px;
    }

    input[type="text"] {
      flex: 1;
      min-width: 240px;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      font-size: 15px;
    }

    button {
      padding: 11px 14px;
      border-radius: 10px;
      border: 1px solid var(--accent);
      background: var(--accent);
      color: #0b1222;
      font-weight: 600;
      cursor: pointer;
      transition: transform 120ms ease, filter 120ms ease;
    }

    button:hover { filter: brightness(1.05); }
    button:active { transform: translateY(1px); }

    .hint {
      width: 100%;
      color: var(--muted);
      font-size: 13px;
    }

    h2 {
      margin: 28px 0 12px;
      font-size: 18px;
      letter-spacing: 0.3px;
    }

    .grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px 16px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .badge {
      background: rgba(56, 189, 248, 0.1);
      color: var(--accent);
      border: 1px solid rgba(56, 189, 248, 0.4);
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: 600;
      font-size: 12px;
    }

    .transposer {
      width: 100%;
      accent-color: var(--accent);
    }

    .keyboard {
      display: flex;
      position: relative;
      height: 90px;
      margin-top: 6px;
    }

    .white-keys {
      display: flex;
      width: 100%;
    }

    .white-key {
      flex: 1;
      background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
      border: 1px solid #94a3b8;
      border-radius: 0 0 6px 6px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding-bottom: 6px;
      font-size: 10px;
      font-weight: 600;
      color: #1e293b;
      min-width: 0;
      position: relative;
      box-shadow: 0 4px 6px rgba(0,0,0,0.15);
      text-align: center;
    }

    .white-key:hover {
      background: linear-gradient(180deg, #ffffff 0%, #f1f5f9 100%);
    }

    .white-key { cursor: pointer; }

    .white-key.active {
      background: linear-gradient(180deg, #38bdf8 0%, #0ea5e9 100%) !important;
      color: #fff;
    }

    .black-keys {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 55px;
      display: flex;
      pointer-events: none;
    }

    .black-key-slot {
      flex: 1;
      display: flex;
      justify-content: center;
      position: relative;
    }

    .black-key {
      position: absolute;
      width: 70%;
      max-width: 48px;
      height: 100%;
      background: linear-gradient(180deg, #334155 0%, #1e293b 100%);
      border: 1px solid #0f172a;
      border-radius: 0 0 4px 4px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding-bottom: 4px;
      font-size: 8px;
      font-weight: 600;
      color: #e2e8f0;
      box-shadow: 0 4px 8px rgba(0,0,0,0.4);
      pointer-events: auto;
      z-index: 1;
      text-align: center;
    }

    .black-key:hover {
      background: linear-gradient(180deg, #475569 0%, #334155 100%);
    }

    .black-key { cursor: pointer; }

    .black-key.active {
      background: linear-gradient(180deg, #0ea5e9 0%, #0284c7 100%) !important;
      color: #fff;
    }

    /* Position black keys between white keys (at right edge of each slot) */
    .black-key-slot:nth-child(1) .black-key { left: 100%; transform: translateX(-50%); } /* C# between C and D */
    .black-key-slot:nth-child(2) .black-key { left: 100%; transform: translateX(-50%); } /* D# between D and E */
    .black-key-slot:nth-child(3) .black-key { display: none; } /* No black key between E and F */
    .black-key-slot:nth-child(4) .black-key { left: 100%; transform: translateX(-50%); } /* F# between F and G */
    .black-key-slot:nth-child(5) .black-key { left: 100%; transform: translateX(-50%); } /* G# between G and A */
    .black-key-slot:nth-child(6) .black-key { left: 100%; transform: translateX(-50%); } /* A# between A and B */
    .black-key-slot:nth-child(7) .black-key { display: none; } /* No key after B */

    .chord-label {
      max-width: 100%;
      padding: 0 2px;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
      line-height: 1.1;
      display: block;
    }

    .empty {
      color: var(--muted);
      font-style: italic;
      padding: 12px 0;
    }

    .summary {
      color: var(--muted);
      font-size: 13px;
      margin: 4px 0 16px;
    }

    .back-link {
      display: inline-block;
      margin-bottom: 8px;
      font-size: 13px;
      color: var(--accent);
      text-decoration: none;
    }

    .back-link:hover {
      text-decoration: underline;
    }

    .keyboard-wrapper {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 6px;
    }

    .keyboard {
      flex: 1;
      margin-top: 0;
    }

    .octave-switcher {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-width: 28px;
      gap: 2px;
    }

    .octave-btn {
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--muted);
      width: 28px;
      height: 28px;
      border-radius: 6px;
      padding: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      line-height: 1;
    }

    .octave-btn:hover {
      color: var(--text);
      background: rgba(255, 255, 255, 0.05);
      border-color: var(--muted);
    }

    .octave-val {
      font-size: 13px;
      font-weight: 600;
      color: var(--accent);
      padding: 2px 0;
      text-align: center;
      font-variant-numeric: tabular-nums;
    }

    /* Chord Popup */
    #chord-popup {
      display: none;
      position: fixed;
      background: var(--panel);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      z-index: 1000;
      pointer-events: none;
      max-width: calc(100vw - 20px);
      overflow: hidden;
    }

    #chord-popup.visible {
      display: block;
    }

    #chord-popup-canvas {
      display: block;
      border-radius: 6px;
      max-width: 100%;
      height: auto;
    }

    #chord-popup-notes {
      margin-top: 8px;
      text-align: center;
      font-size: 13px;
      font-weight: 600;
      color: var(--accent);
      letter-spacing: 0.5px;
      overflow-wrap: break-word;
    }

    /* Responsive popup for mobile */
    @media (max-width: 767px) {
      #chord-popup {
        padding: 8px;
        border-radius: 8px;
      }

      #chord-popup-notes {
        font-size: 11px;
        margin-top: 6px;
      }
    }

    /* Note source toggle (J6 / Interval) */
    .transposer-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .transposer-info .summary {
      margin: 0;
    }

    .note-source-toggle {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      white-space: nowrap;
      user-select: none;
    }

    .toggle-label {
      color: var(--muted);
      transition: color 150ms;
    }

    .toggle-label.active {
      color: var(--accent);
    }

    .note-source-switch {
      position: relative;
      width: 28px;
      height: 16px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--border);
      border-radius: 999px;
      cursor: pointer;
      transition: background 150ms;
      margin: 0;
      flex-shrink: 0;
      border: none;
      outline: none;
      padding: 0;
    }

    .note-source-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 12px;
      height: 12px;
      background: var(--accent);
      border-radius: 50%;
      transition: transform 150ms;
    }

    .note-source-switch:checked::after {
      transform: translateX(12px);
    }

    /* ‚îÄ‚îÄ Synth controls ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .synth-panel {
      padding: 14px 24px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: start;
      font-size: 13px;
    }
    .synth-group {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 12px 10px;
      margin: 0;
      background: var(--panel);
      display: flex;
      flex-wrap: wrap;
      gap: 6px 14px;
      align-items: end;
    }
    .synth-group legend {
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--accent);
      padding: 0 6px;
      margin: 0;
    }
    .synth-group legend label {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      margin: 0;
    }
    .synth-group legend label input[type="checkbox"] {
      accent-color: var(--accent);
      margin: 0;
      cursor: pointer;
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      align-self: center;
    }
    .synth-group.disabled-group label:not(legend label) {
      opacity: 0.35;
      pointer-events: none;
    }
    .synth-panel label {
      display: flex;
      flex-direction: column;
      gap: 3px;
      color: var(--muted);
    }
    .synth-panel label span {
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }
    .synth-panel label .synth-val {
      color: var(--accent);
      font-variant-numeric: tabular-nums;
      min-width: 3.2em;
      text-align: right;
    }
    .synth-panel select,
    .synth-panel input[type="range"] {
      accent-color: var(--accent);
      background: var(--bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 4px 6px;
      font-size: 13px;
    }
    .synth-panel input[type="range"] {
      width: 100px;
    }
    #synthReset {
      padding: 6px 12px;
      font-size: 12px;
      align-self: center;
    }
    /* ‚îÄ‚îÄ Oscilloscope ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    /* ‚îÄ‚îÄ Collapsible sections ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .collapsible-section {
      border-bottom: 1px solid var(--border);
    }
    .collapsible-section > summary {
      padding: 10px 24px;
      cursor: pointer;
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--accent);
      list-style: none;
      display: flex;
      align-items: center;
      gap: 6px;
      user-select: none;
    }
    .collapsible-section > summary::-webkit-details-marker { display: none; }
    .collapsible-section > summary::before {
      content: '‚ñ∂';
      font-size: 10px;
      transition: transform 150ms ease;
    }
    .collapsible-section[open] > summary::before {
      transform: rotate(90deg);
    }
    /* ‚îÄ‚îÄ MIDI keyboard selection ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .card.midi-selected {
      box-shadow: 0 0 0 2px var(--accent), 0 6px 18px rgba(56, 189, 248, 0.4);
      background: rgba(56, 189, 248, 0.05);
    }
    .scope-wrap {
      padding: 0 24px 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .scope-wrap .scope-header {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 12px;
      color: var(--muted);
    }
    .scope-wrap .scope-header span { text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; color: var(--accent); }
    #scopeCanvas {
      width: 100%;
      height: 100px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #0a0f1a;
    }

    /* ‚îÄ‚îÄ Welcome splash modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    #welcomeOverlay {
      position: fixed; inset: 0;
      z-index: 10000;
      display: flex; align-items: center; justify-content: center;
      background: rgba(15, 23, 42, 0.92);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      cursor: pointer;
    }
    #welcomeOverlay.hidden { display: none; }
    #welcomeBox {
      text-align: center;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 2.5rem 2rem 2rem;
      max-width: 380px;
      width: 90%;
      box-shadow: 0 8px 32px rgba(0,0,0,0.5);
    }
    #welcomeBox h2 {
      margin: 0 0 0.3rem;
      font-size: 1.35rem;
      color: var(--accent);
    }
    #welcomeBox p {
      margin: 0 0 1.5rem;
      color: var(--muted);
      font-size: 0.9rem;
      line-height: 1.4;
    }
    #welcomeBtn {
      display: inline-block;
      padding: 0.6rem 2rem;
      font-size: 1rem;
      font-weight: 600;
      color: #0f172a;
      background: var(--accent);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: opacity 0.15s;
    }
    #welcomeBtn:hover { opacity: 0.85; }
  </style>
</head>
<body>
  <!-- Welcome splash ‚Äî guarantees a user gesture before audio -->
  <div id="welcomeOverlay">
    <div id="welcomeBox">
      <h2>üéπ J-6 Chord Browser</h2>
      <p>Browse and play all 100 Roland J-6 chord sets.<br>Click or right-click keys to hear chords.</p>
      <p style="margin:0;color:var(--muted);font-size:0.8rem;">Click anywhere to continue</p>
    </div>
  </div>

  <header>
    <a href="./index.html" class="back-link">‚Üê Back to Tools</a>
    <h1>Roland J-6 Chord Sequence Search and Browser</h1>
    <p>Client-side search and browse of all chord sets. No server required.</p>
  </header>

  <details class="collapsible-section">
    <summary>Synth engine</summary>
    <div class="synth-panel" id="synthPanel">
    <fieldset class="synth-group" style="width: 100%; max-width: 300px;">
      <legend>Preset</legend>
      <label>
        <span>Load Preset</span>
        <select id="synthPreset">
          <option value="">-- Select Preset --</option>
          <optgroup label="Plucks">
            <option value="classicPluck">Classic Pluck</option>
            <option value="brightPluck">Bright Pluck</option>
            <option value="softPluck">Soft Pluck</option>
            <option value="metallicPluck">Metallic Pluck</option>
            <option value="bassPluck">Bass Pluck</option>
          </optgroup>
          <optgroup label="Pads">
            <option value="warmPad">Warm Pad</option>
            <option value="brightPad">Bright Pad</option>
            <option value="choirPad">Choir Pad</option>
            <option value="stringPad">String Pad</option>
            <option value="darkPad">Dark Pad</option>
          </optgroup>
          <optgroup label="Leads">
            <option value="classicLead">Classic Lead</option>
            <option value="brightLead">Bright Lead</option>
            <option value="smoothLead">Smooth Lead</option>
            <option value="vintageLead">Vintage Lead</option>
            <option value="synthLead">Synth Lead</option>
          </optgroup>
          <optgroup label="Experimental">
            <option value="wobble">Wobble</option>
            <option value="tremolo">Tremolo</option>
            <option value="resonantSweep">Resonant Sweep</option>
            <option value="phaser">Phaser</option>
            <option value="glitch">Glitch</option>
          </optgroup>
        </select>
      </label>
    </fieldset>

    <fieldset class="synth-group">
      <legend>Oscillator</legend>
      <label>
        <span>Wave</span>
        <select id="synthWave">
          <option value="triangle">Triangle</option>
          <option value="sawtooth" selected>Sawtooth</option>
          <option value="square">Square</option>
          <option value="sine">Sine</option>
        </select>
      </label>
      <label>
        <span>Voices <span class="synth-val" id="synthUnisonVoicesVal">1</span></span>
        <input type="range" id="synthUnisonVoices" min="1" max="8" step="1" value="1" />
      </label>
      <label>
        <span>Detune <span class="synth-val" id="synthUnisonDetuneVal">10 ct</span></span>
        <input type="range" id="synthUnisonDetune" min="0" max="100" step="1" value="10" />
      </label>
    </fieldset>

    <fieldset class="synth-group" id="ampEnvGroup">
      <legend><label><input type="checkbox" id="synthAmpEnvEnabled" checked /> Amp Envelope</label></legend>
      <label>
        <span>Attack <span class="synth-val" id="synthAVal">0.03</span></span>
        <input type="range" id="synthAttack" min="0.001" max="1" step="0.001" value="0.03" />
      </label>
      <label>
        <span>Decay <span class="synth-val" id="synthDVal">1.00s</span></span>
        <input type="range" id="synthDecay" min="0" max="1" step="0.01" value="1.00" />
      </label>
      <label>
        <span>Sustain <span class="synth-val" id="synthSVal">0%</span></span>
        <input type="range" id="synthSustain" min="0" max="1" step="0.01" value="0" />
      </label>
      <label>
        <span>Release <span class="synth-val" id="synthRVal">0.01s</span></span>
        <input type="range" id="synthRelease" min="0.01" max="3" step="0.01" value="0.01" />
      </label>
    </fieldset>

    <fieldset class="synth-group" id="filterGroup">
      <legend><label><input type="checkbox" id="synthFilterEnabled" checked /> Filter</label></legend>
      <label>
        <span>Cutoff <span class="synth-val" id="synthCutoffVal">2943</span></span>
        <input type="range" id="synthCutoff" min="100" max="20000" step="1" value="2943" />
      </label>
      <label>
        <span>Q <span class="synth-val" id="synthQVal">6.3</span></span>
        <input type="range" id="synthQ" min="0.1" max="20" step="0.1" value="6.3" />
      </label>
    </fieldset>

    <fieldset class="synth-group" id="filterEnvGroup">
      <legend><label><input type="checkbox" id="synthFilterEnvEnabled" checked /> Filter Envelope</label></legend>
      <label>
        <span>Attack <span class="synth-val" id="synthFAVal">0.00</span></span>
        <input type="range" id="synthFilterAttack" min="0" max="2" step="0.01" value="0" />
      </label>
      <label>
        <span>Decay <span class="synth-val" id="synthFDVal">0.29s</span></span>
        <input type="range" id="synthFilterDecay" min="0" max="2" step="0.01" value="0.29" />
      </label>
      <label>
        <span>Sustain <span class="synth-val" id="synthFSVal">0%</span></span>
        <input type="range" id="synthFilterSustain" min="0" max="1" step="0.01" value="0" />
      </label>
      <label>
        <span>Release <span class="synth-val" id="synthFRVal">0.01s</span></span>
        <input type="range" id="synthFilterRelease" min="0.01" max="3" step="0.01" value="0.01" />
      </label>
    </fieldset>

    <fieldset class="synth-group" id="lfoGroup">
      <legend><label><input type="checkbox" id="synthLfoEnabled" /> LFO</label></legend>
      <label>
        <span>Target</span>
        <select id="synthLfoTarget">
          <option value="cutoff" selected>Filter Cutoff</option>
          <option value="q">Filter Q</option>
          <option value="pitch">Pitch</option>
        </select>
      </label>
      <label>
        <span>Wave</span>
        <select id="synthLfoWave">
          <option value="sine" selected>Sine</option>
          <option value="triangle">Triangle</option>
          <option value="sawtooth">Sawtooth</option>
          <option value="square">Square</option>
        </select>
      </label>
      <label>
        <span>Rate <span class="synth-val" id="synthLfoRateVal">2.0 Hz</span></span>
        <input type="range" id="synthLfoRate" min="0.1" max="20" step="0.1" value="2.0" />
      </label>
      <label>
        <span>Depth <span class="synth-val" id="synthLfoDepthVal">50%</span></span>
        <input type="range" id="synthLfoDepth" min="0" max="1" step="0.01" value="0.5" />
      </label>
    </fieldset>

    <button id="synthReset">Reset</button>
  </div>
  </details>

  <details class="collapsible-section">
    <summary>Oscilloscope</summary>
    <div class="scope-wrap">
    <div class="scope-header">
      <span>Scope</span>
      <label style="cursor:pointer;">Mode:
        <select id="scopeMode" style="background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:4px;padding:2px 4px;font-size:12px;">
          <option value="envelope">Envelope</option>
          <option value="waveform">Waveform</option>
        </select>
      </label>
      <label style="cursor:pointer;">Window:
        <select id="scopeWindow" style="background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:4px;padding:2px 4px;font-size:12px;">
          <option value="1">1 s</option>
          <option value="2" selected>2 s</option>
          <option value="4">4 s</option>
        </select>
      </label>
    </div>
    <canvas id="scopeCanvas"></canvas>
  </div>
  </details>

  <details class="collapsible-section">
    <summary>MIDI Input</summary>
    <div class="synth-panel" id="midiPanel">
      <fieldset class="synth-group" id="midiGroup">
        <legend><label><input type="checkbox" id="midiEnabled" /> Enable MIDI</label></legend>
        <label>
          <span>Device</span>
          <select id="midiDevice">
            <option value="">No MIDI devices</option>
          </select>
        </label>
        <label>
          <span>Channel <span class="synth-val" id="midiChannelVal">All</span></span>
          <select id="midiChannel">
            <option value="0">All Channels</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
          </select>
        </label>
      </fieldset>
      <div style="width:100%;color:var(--muted);font-size:12px;padding:0 12px;">
        Click on a chord set card to select it for MIDI playback. Selected card will glow.
      </div>
    </div>
  </details>

  <details class="collapsible-section">
    <summary>Search</summary>
    <div class="container">
      <section class="controls">
        <input id="search" type="text" placeholder="Search chords (use * or ? wildcards, space/comma separated)" autocomplete="off" />
        <button id="clear">Clear</button>
        <div class="hint">Checks every progression across 12 semitone transpositions. Example: <code>G*</code> <code>*m7</code> <code>D?/F#</code></div>
      </section>

      <section>
        <div class="card" style="padding:12px 14px 10px;">
          <div class="card-header" style="margin-bottom:6px;">
            <h2 style="margin:0; font-size:16px;">Search results</h2>
            <span class="summary" id="resultSummary"></span>
          </div>
          <div id="results" class="grid"></div>
        </div>
      </section>
    </div>
  </details>

  <details class="collapsible-section" open>
    <summary>Browse</summary>
    <div class="container">
      <section>
        <div id="browser" class="grid"></div>
      </section>
    </div>
  </details>

  <!-- Chord Popup -->
  <div id="chord-popup">
    <canvas id="chord-popup-canvas" width="1050" height="80"></canvas>
    <div id="chord-popup-notes"></div>
  </div>

  <!-- Raw chord data taken from InitializeChordSets in MainWindow.xaml.cs -->
  <script type="application/csharp" id="chord-data">
      return
      [
            new()
            {
              Number = 1,
              Name = "Pop",
              Chords =
              [
                "Cadd9",
                "C#M9/C",
                "Dm7",
                "D#M7",
                "Cadd9/E",
                "FM9",
                "Dadd9/F#",
                "Em7/G",
                "Fm6/G#",
                "FM/A",
                "Gm/A#",
                "G/B"
              ]
            },

            new()
            {
              Number = 2,
              Name = "Pop",
              Chords =
              [
                "CM9",
                "C#dim7",
                "Dm9",
                "D#dim7",
                "Em7",
                "FM9",
                "F#m7b5",
                "F/A",
                "G#dim7",
                "Am9",
                "C/A#",
                "Bm7b5"
              ]
            },

            new()
            {
              Number = 3,
              Name = "Jazz",
              Chords =
              [
                "D7sus2/C",
                "C#7#9",
                "Dm9",
                "D7#9",
                "E7#9",
                "FM9",
                "F#7#9",
                "G7(13)",
                "G#7(13)",
                "Am7(11)",
                "A#9",
                "Bm7(11)"
              ]
            },

            new()
            {
              Number = 4,
              Name = "Jazz",
              Chords =
              [
                "Dsus2/C",
                "C#7#9",
                "Dm9",
                "D#9",
                "Em9",
                "Fm9",
                "F#m7b5",
                "Gaug7",
                "G#7(13)",
                "Aaug7",
                "A#7(13)",
                "Bm7(11)"
              ]
            },

            new()
            {
              Number = 5,
              Name = "Jazz",
              Chords =
              [
                "CM9",
                "C#M7",
                "DM9",
                "D#M9",
                "EM9",
                "FM9",
                "F#M9",
                "GM9",
                "G#M9",
                "AM9",
                "A#M9",
                "BM9"
              ]
            },

            new()
            {
              Number = 6,
              Name = "Blues",
              Chords =
              [
                "C9",
                "C#9",
                "D9",
                "D#9",
                "E7#9",
                "Fm9",
                "F#dim7",
                "G7(13)",
                "G#dim7",
                "Aaug7",
                "A#7(13)",
                "Bm7b5"
              ]
            },

            new()
            {
              Number = 7,
              Name = "Trad Maj",
              Chords =
              [
                "C",
                "C#dim7",
                "Dm",
                "D#dim7",
                "Em",
                "F",
                "F#m7b5",
                "G",
                "G#dim7",
                "Am",
                "A#",
                "Bdim"
              ]
            },

            new()
            {
              Number = 8,
              Name = "Trad Min",
              Chords =
              [
                "Cm",
                "C#",
                "Ddim",
                "Eb",
                "Edim7",
                "Fm",
                "F#dim7",
                "Gm",
                "G#",
                "Am7b5",
                "A#",
                "Bdim7"
              ]
            },

            new()
            {
              Number = 9,
              Name = "Trad Min 2",
              Chords =
              [
                "Cm",
                "C#",
                "Ddim",
                "D#aug",
                "Em",
                "Fm",
                "F#dim7",
                "G",
                "G#",
                "Am7b5",
                "A#",
                "Bdim"
              ]
            },

            new()
            {
              Number = 10,
              Name = "Pop Min",
              Chords =
              [
                "Cmadd9",
                "C#M7",
                "Dm7b5",
                "D#M7",
                "Edim7",
                "Fm9",
                "F#dim7",
                "Gm7",
                "G#M7",
                "Am7b5",
                "G#/A#",
                "Bdim7"
              ]
            },

            new()
            {
              Number = 11,
              Name = "Pop Min",
              Chords =
              [
                "Cmadd9",
                "Gdim/C#",
                "Dm7b5",
                "D#M7",
                "EM9",
                "Fm9",
                "F#dim7",
                "Gaug7",
                "G#M7",
                "Am7b5",
                "Cm7/A#",
                "Baug#9"
              ]
            },

            new()
            {
              Number = 12,
              Name = "Jazz Min",
              Chords =
              [
                "Cm7(11)",
                "C#7#9",
                "Dm7b5",
                "D#M7#5",
                "E9",
                "F9",
                "F#dim7",
                "G7#9",
                "G#M7b5",
                "Am7b5",
                "A#m7",
                "Bdim7"
              ]
            },

            new()
            {
              Number = 13,
              Name = "Jazz Min",
              Chords =
              [
                "Cm9",
                "C#9",
                "Dm9",
                "D#9",
                "EM9",
                "Fm9",
                "F#dim7",
                "G7(13)",
                "G#m6",
                "Am7b5",
                "A#m7",
                "Bm7b5"
              ]
            },
            new()
            {
            Number = 14,
            Name = "Oct Stack",
            Chords = ["Coct", "C#oct", "Doct", "D#oct", "Eoct", "Foct", "F#oct", "Goct", "G#oct", "Aoct", "A#oct", "Boct"]
            },

            new()
            {
            Number = 15,
            Name = "4th Stack",
            Chords = ["C4th", "C#4th", "D4th", "D#4th", "E4th", "F4th", "F#4th", "G4th", "G#4th", "A4th", "A#4th", "B4th"]
            },

            new()
            {
            Number = 16,
            Name = "5th Stack",
            Chords = ["C5th", "C#5th", "D5th", "D#5th", "E5th", "F5th", "F#5th", "G5th", "G#5th", "A5th", "A#5th", "B5th"]
            },
            new()
            {
              Number = 17,
              Name = "Utility",
              Chords =
              [
                "C",
                "C#",
                "D",
                "D#",
                "E",
                "F",
                "F#",
                "G",
                "G#",
                "A",
                "A#",
                "B"
              ]
            },

            new()
            {
              Number = 18,
              Name = "Utility",
              Chords =
              [
                "Cm",
                "C#m",
                "Dm",
                "D#m",
                "E",
                "Fm",
                "F#m",
                "Gm",
                "G#m",
                "Am",
                "A#m",
                "Bm"
              ]
            },

            new()
            {
              Number = 19,
              Name = "Utility",
              Chords =
              [
                "CM7",
                "C#M7",
                "DM7",
                "D#M7",
                "EM7",
                "FM7",
                "F#M7",
                "GM7",
                "G#M7",
                "AM7",
                "A#M7",
                "BM7"
              ]
            },

            new()
            {
              Number = 20,
              Name = "Utility",
              Chords =
              [
                "Cm7",
                "C#m7",
                "Dm7",
                "D#m7",
                "Em7",
                "Fm7",
                "F#m7",
                "Gm7",
                "G#m7",
                "Am7",
                "A#m7",
                "Bm7"
              ]
            },

            new()
            {
              Number = 21,
              Name = "Utility",
              Chords =
              [
                "CM9",
                "C#M9",
                "DM9",
                "D#M9",
                "EM9",
                "FM9",
                "F#M9",
                "GM9",
                "G#M9",
                "AM9",
                "A#M9",
                "BM9"
              ]
            },

            new()
            {
              Number = 22,
              Name = "Utility",
              Chords =
              [
                "Cm9",
                "C#m9",
                "Dm9",
                "D#m9",
                "Em9",
                "Fm9",
                "F#m9",
                "Gm9",
                "G#m9",
                "Am9",
                "A#m9",
                "Bm9"
              ]
            },

            new()
            {
              Number = 23,
              Name = "Utility",
              Chords =
              [
                "CM9#11",
                "C#M9#11",
                "DM9#11",
                "D#M9#11",
                "EM9#11",
                "FM9#11",
                "F#M9#11",
                "GM9#11",
                "G#M9#11",
                "AM9#11",
                "A#M9#11",
                "BM9#11"
              ]
            },

            new()
            {
              Number = 24,
              Name = "Utility",
              Chords =
              [
                "Cm9/11",
                "C#m9/11",
                "Dm9/11",
                "D#m9/11",
                "Em9/11",
                "Fm9/11",
                "F#m9/11",
                "Gm9/11",
                "G#m9/11",
                "Am9/11",
                "A#m9/11",
                "Bm9/11"
              ]
            },

            new()
            {
              Number = 26,
              Name = "Utility",
              Chords =
              [
                "Cm7",
                "Cm7/D#",
                "Cm7/G",
                "Cm7/A#",
                "Cm7",
                "Cm7/D#",
                "Cm7",
                "Cm7/G",
                "Cm7",
                "Cm7/D#",
                "Cm7/G",
                "Cm7/A#"
              ]
            },

            new()
            {
              Number = 27,
              Name = "Pop/Synth",
              Chords =
              [
                "C",
                "Em",
                "G",
                "Am",
                "Bm",
                "C",
                "Em",
                "G",
                "Am",
                "Bm",
                "C",
                "Em"
              ]
            },

            new()
            {
              Number = 28,
              Name = "Pop",
              Chords =
              [
                "C",
                "C7",
                "Dm7",
                "D#M7",
                "C/E",
                "F",
                "Fm",
                "G",
                "C/G",
                "Am7",
                "Eaug/A#",
                "G7/B"
              ]
            },

            new()
            {
              Number = 29,
              Name = "Pop",
              Chords =
              [
                "C",
                "FM7",
                "G",
                "Em7",
                "Dm7",
                "CM7/E",
                "F",
                "D7/G",
                "G",
                "Am",
                "Dm",
                "G7"
              ]
            },

            new()
            {
              Number = 30,
              Name = "Pop",
              Chords =
              [
                "Cm",
                "D#",
                "G#",
                "A#",
                "Gm",
                "G#",
                "D#",
                "A#sus4/D",
                "Cm",
                "G/B",
                "G#",
                "F/A"
              ]
            },

            new()
            {
              Number = 31,
              Name = "Pop",
              Chords =
              [
                "Cadd11",
                "Bb/C",
                "Dm7",
                "D7",
                "Cadd9/E",
                "FM7",
                "F7",
                "Gm7",
                "A/G",
                "FM7/A",
                "F/Bb",
                "G7/B"
              ]
            },

            new()
            {
              Number = 32,
              Name = "Pop",
              Chords =
              [
                "Cmb13",
                "D#M7",
                "G7/D",
                "A#/D#",
                "C7",
                "Fm7",
                "D#",
                "Gm7",
                "G#M9",
                "G#m6",
                "F7/A",
                "A#add11"
              ]
            },

            new()
            {
              Number = 33,
              Name = "Cinematic",
              Chords =
              [
                "CM7",
                "F/E",
                "A#M7",
                "G",
                "Dm7",
                "C",
                "A#M7",
                "G",
                "C",
                "A/C#",
                "Dm",
                "G/F"
              ]
            },

            new()
            {
              Number = 34,
              Name = "Cinematic/Synthwave",
              Chords =
              [
                "Csus2",
                "Dsus2",
                "D#sus2",
                "Fsus2",
                "Gsus2",
                "A#sus2",
                "Csus2",
                "Dsus2",
                "D#sus2",
                "Fsus2",
                "Gsus2",
                "A#sus2"
              ]
            },

            new()
            {
              Number = 35,
              Name = "Cinematic/House",
              Chords =
              [
                "CM7",
                "Am7",
                "DM7",
                "Bm7",
                "EM7",
                "C#m7",
                "F#M7",
                "D#m7",
                "G#M7",
                "Fm7",
                "A#M7",
                "Gm7"
              ]
            },

            new()
            {
              Number = 36,
              Name = "Cinematic",
              Chords =
              [
                "Ebsus2/C",
                "Fsus2/D",
                "Gsus2/E",
                "Absus2/F",
                "Bbsus2/G",
                "Csus2/A",
                "Dsus2/B",
                "Ebsus2/C",
                "Fsus2/D",
                "Gsus2/E",
                "Absus2/F",
                "Bbsus2/G"
              ]
            },

            new()
            {
              Number = 37,
              Name = "Cinematic",
              Chords = new List<string>
              {
                "C6sus2",
                "Dsus2",
                "Emadd11",
                "Dadd9/F#",
                "Gadd9",
                "Am7/11",
                "Bm7",
                "C6",
                "D6",
                "Emadd9",
                "E7sus4",
                "Em7b5/F"
              }
            },
            new()
            {
              Number = 38,
              Name = "New Age/Cinematic",
              Chords = new List<string>
              {
                "C",
                "Gsus4",
                "G7sus4",
                "A#/D#",
                "C/E",
                "Gsus4/F",
                "D/F#",
                "C/G",
                "E/G#",
                "Am",
                "Fsus4",
                "G"
              }
            },
            new()
            {
              Number = 39,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "C6sus4",
                "Gmadd9/D",
                "Edim11",
                "Fsus2/D",
                "BbM7",
                "Gmadd9",
                "Am/G",
                "C7/G",
                "A#M7",
                "Gm/A",
                "C7/A#",
                "A#m6"
              }
            },
            new()
            {
              Number = 40,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "Cadd9",
                "Dadd9",
                "D#add9",
                "Fadd9",
                "Gadd9",
                "G#add9",
                "A#add9",
                "Cadd9",
                "Dadd9",
                "D#add9",
                "Fadd9",
                "Gadd9"
              }
            },
            new()
            {
              Number = 41,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "C",
                "C#dim7",
                "Fsus2/D",
                "D#add9",
                "Csus2/E",
                "FM7",
                "F#dim",
                "Gsus4",
                "G#6",
                "Csus2/A",
                "Csus2/A#",
                "G7/B"
              }
            },
            new()
            {
              Number = 42,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "C",
                "A#sus2/D#",
                "A#7/G#",
                "G/B",
                "C",
                "Fm",
                "F#dim7",
                "C",
                "G#add9",
                "F/A",
                "A#",
                "G7/B"
              }
            },
            new()
            {
              Number = 43,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "Cm7",
                "A#/C",
                "D#/G#",
                "A#/G#",
                "D#/F",
                "A#/F",
                "G#add9",
                "A#",
                "G#M7",
                "Fsus2/A",
                "A#6",
                "Fm7/B"
              }
            },
            new()
            {
              Number = 44,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "Cm7",
                "C#sus2/F",
                "Gm7",
                "D#",
                "Csus2/E",
                "Fm",
                "D#dim7",
                "G#sus2/G",
                "Cm7",
                "F7",
                "Fm7",
                "G5"
              }
            },
            new()
            {
              Number = 45,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "Ab",
                "Fm",
                "Gm",
                "Ab",
                "Fm",
                "Bb",
                "Gm",
                "Cm",
                "Ab",
                "Fm",
                "Bb",
                "Cm"
              }
            },
            new()
            {
              Number = 46,
              Name = "Synthwave",
              Chords = new List<string>
              {
                "C",
                "D",
                "Em",
                "D",
                "G",
                "Am",
                "Bm",
                "C",
                "D",
                "Em",
                "D",
                "G"
              }
            },
            new()
            {
              Number = 47,
              Name = "Synthwave/House",
              Chords = new List<string>
              {
                "Cm7",
                "D#M7",
                "Dm7",
                "Fm7",
                "D#M7",
                "Gm7",
                "Fm7",
                "G#M7",
                "Gm7",
                "A#7",
                "G#M7",
                "C#/C"
              }
            },
            new()
            {
              Number = 48,
              Name = "Trance",
              Chords = new List<string>
              {
                "Cm",
                "Ab/C",
                "Bb/D",
                "Eb",
                "C/E",
                "Fm",
                "F",
                "Gm",
                "Ab",
                "F7/A",
                "Bb",
                "G7/B"
              }
            },
            new()
            {
              Number = 49,
              Name = "House",
              Chords = new List<string>
              {
                "Cm7",
                "C#m7",
                "Dm7",
                "EbM7",
                "Gm/E",
                "Eb/F",
                "D7/F#",
                "Gm7",
                "AbM7",
                "Ab/Bb",
                "BbM7",
                "Bm7b5"
              }
            },
            new()
            {
              Number = 50,
              Name = "House",
              Chords = new List<string>
              {
                "Cmaj7",
                "Dmaj7",
                "Em7",
                "Fmaj9",
                "Gmaj9",
                "Eadd9/G#",
                "Am7",
                "Bm7",
                "Cmaj9",
                "Dm7/9",
                "Em7",
                "Fmaj7"
              }
            },
            new()
            {
              Number = 51,
              Name = "House",
              Chords = new List<string>
              {
                "Cm7",
                "G#/C#",
                "Dm7",
                "A#/D#",
                "Em7",
                "C/F",
                "F#m7",
                "D/G",
                "G#m7",
                "E/A",
                "A#m7",
                "F#/B"
              }
            },
            new()
            {
              Number = 52,
              Name = "House",
              Chords = new List<string>
              {
                "Cm7",
                "G#M7",
                "Dm7",
                "A#M7",
                "Em7",
                "CM7",
                "F#m7",
                "DM7",
                "G#m7",
                "EM7",
                "A#m7",
                "F#M7"
              }
            },
            new()
            {
              Number = 53,
              Name = "House",
              Chords = new List<string>
              {
                "Cm7/11",
                "Cdim7",
                "C#M7b5",
                "Ddim7",
                "Cm",
                "C#M7",
                "CM7",
                "Em7",
                "FM7",
                "Fm6",
                "Csus2/E",
                "Fm"
              }
            },
            new()
            {
              Number = 54,
              Name = "House",
              Chords = new List<string>
              {
                "CM7",
                "Em7",
                "Dm7",
                "FM7",
                "D#M7",
                "Gm7",
                "FM7",
                "Am7",
                "Gm7",
                "A#M7",
                "Am7",
                "Bm7"
              }
            },
            new()
            {
              Number = 55,
              Name = "Jazz House",
              Chords = new List<string>
              {
                "CM13",
                "CM7#5",
                "Dm7b5",
                "G7",
                "Cadd9/E",
                "Fadd9",
                "FmAdd9",
                "G9",
                "E7/G#",
                "Am9/11",
                "Gm11/Bb",
                "CM7#5/G#"
              }
            },
            new()
            {
              Number = 56,
              Name = "Jazz House",
              Chords = new List<string>
              {
                "Cm7",
                "Db6",
                "Dm7",
                "Dm7b5",
                "EbM7",
                "Fm7",
                "Gb6",
                "Gm7",
                "Ab6",
                "AbM7",
                "Am7",
                "BbM7"
              }
            },
            new()
            {
              Number = 57,
              Name = "House/Techno",
              Chords = new List<string>
              {
                "C5b9",
                "DbM7",
                "Dm7",
                "Ebsus11",
                "EM7#11",
                "Fm9",
                "GbM7#11",
                "Gm7",
                "AbM7#11",
                "A7alt",
                "Bb5add9b13",
                "C7sus4"
              }
            },
            new()
            {
              Number = 58,
              Name = "Techno",
              Chords = new List<string>
              {
                "Cm7",
                "A#m/C#",
                "A#/D",
                "D#",
                "C/E",
                "Cm/F",
                "D/F#",
                "G",
                "G#M7",
                "Csus4/A",
                "D#/A#",
                "G/B"
              }
            },
            new()
            {
              Number = 59,
              Name = "EDM",
              Chords = new List<string>
              {
                "CM9",
                "C6",
                "Dm9",
                "Dm6",
                "EM9",
                "FM9",
                "F6",
                "GM9",
                "G6",
                "Am9",
                "Am6",
                "Bm9"
              }
            },
            new()
            {
              Number = 60,
              Name = "EDM",
              Chords = new List<string>
              {
                "CM13(no 3)",
                "EM9(no 3)",
                "DM13(no 3)",
                "F#M9(no 3)",
                "EM13(no 3)",
                "FM13(no 3)",
                "AM9(no 3)",
                "GM13(no 3)",
                "BM9(no 3)",
                "AM13(no 3)",
                "C#M9(no 3)",
                "BM13(no 3)"
              }
            },
            new()
            {
              Number = 61,
              Name = "EDM",
              Chords = new List<string>
              {
                "Csus9/13",
                "C6",
                "Dsus9/13",
                "D6",
                "Esus9/13",
                "Fsus9/13",
                "F6",
                "Gsus9/13",
                "G6",
                "Asus9/13",
                "A6",
                "Bsus9/13"
              }
            },
            new()
            {
              Number = 62,
              Name = "EDM",
              Chords = new List<string>
              {
                "CM13",
                "C#sus9",
                "DM13",
                "D#sus9",
                "EM13",
                "FM13",
                "F#sus9",
                "Gmaj13",
                "Absus9",
                "AM13",
                "Bbsus9",
                "BM13"
              }
            },
            new()
            {
              Number = 63,
              Name = "EDM",
              Chords = new List<string>
              {
                "CM7",
                "Dbm7",
                "Dm7",
                "Eb6",
                "Em7",
                "FM7",
                "Gbm7",
                "GM7",
                "Abm7",
                "Am7",
                "Bb6",
                "Bm7"
              }
            },
            new()
            {
              Number = 64,
              Name = "EDM",
              Chords = new List<string>
              {
                "C6",
                "AM7",
                "D6",
                "BM7",
                "E6",
                "F6",
                "DM7",
                "G6",
                "EM7",
                "A6",
                "GbM7",
                "B6"
              }
            },
            new()
            {
              Number = 65,
              Name = "Gospel/R&B",
              Chords = new List<string>
              {
                "G/C",
                "C#dim7",
                "Dm7b5",
                "D#dim7",
                "Em7",
                "Fm11",
                "F#dim7",
                "Gm7b13",
                "G#M9",
                "Am7b13",
                "A#m7add13",
                "Bm7b13"
              }
            },
            new()
            {
              Number = 66,
              Name = "Gospel/R&B",
              Chords = new List<string>
              {
                "Cm7b13",
                "C#M13",
                "Dm7b13",
                "D#m11",
                "D/E",
                "G#m/F",
                "F#6",
                "A#m/G",
                "G#m11",
                "AM9",
                "A#7b13",
                "F#/B"
              }
            },
            new()
            {
              Number = 67,
              Name = "Gospel/R&B",
              Chords = new List<string>
              {
                "D",
                "C/D",
                "D/E",
                "Dm/F",
                "Dsus2/F#",
                "Gadd9",
                "E/G#",
                "A",
                "A#dim7",
                "Bm7",
                "D/C",
                "C#dim"
              }
            },
            new()
            {
              Number = 68,
              Name = "Lofi R&B",
              Chords = new List<string>
              {
                "Cmadd9",
                "Abadd9/C",
                "Bb7/D",
                "EbM9",
                "Eb7b9",
                "Fm9",
                "GbM6/9",
                "Gm7",
                "Eb/Ab",
                "Fsus4/A",
                "Bbsus",
                "Bbsus4b9"
              }
            },
            new()
            {
              Number = 69,
              Name = "Lofi R&B",
              Chords = new List<string>
              {
                "Ab7/C",
                "C#m11",
                "DM9",
                "Bsus4/Eb",
                "EMadd2",
                "DM7#11",
                "F#m11",
                "G6",
                "Abm7",
                "AM7add6",
                "F#add9/A#",
                "BMadd4"
              }
            },
            new()
            {
              Number = 70,
              Name = "Funk",
              Chords = new List<string>
              {
                "C9",
                "C/D",
                "D7b9",
                "EbM7",
                "Em7b13",
                "Eb/F",
                "F#13",
                "G7",
                "Abm6addb13",
                "Am7",
                "Bm7",
                "B7"
              }
            },
            new()
            {
              Number = 71,
              Name = "Funk",
              Chords = new List<string>
              {
                "C7alt",
                "DbM7",
                "D7alt",
                "Eb7",
                "C7/E",
                "F7alt",
                "F11sus2",
                "Gm7b5",
                "Ab9",
                "Bb9sus",
                "Bb7add9",
                "C11sus2"
              }
            },
            new()
            {
              Number = 72,
              Name = "Neo Soul",
              Chords = new List<string>
              {
                "Cm9",
                "AbM7",
                "Dm7",
                "EbDimM7",
                "EbM7",
                "Fm7",
                "CM7#5",
                "Gm7",
                "G7#5",
                "AbM7",
                "Fm7b5/B",
                "Bb13/D"
              }
            },
            new()
            {
              Number = 73,
              Name = "Neo Soul",
              Chords = new List<string>
              {
                "Cm7",
                "C#dim7",
                "Fm7",
                "Fm7b5",
                "EbM7",
                "Cm7/Eb",
                "Edim",
                "AbM7",
                "Fm7",
                "AbM13",
                "Bb13",
                "Bb6"
              }
            },
            new()
            {
              Number = 74,
              Name = "Neo Soul",
              Chords = new List<string>
              {
                "Em7/D",
                "Gm7b5/C#",
                "FM7/E",
                "DMb7/D#",
                "GM7/F#",
                "Edim7",
                "Cadd13/E",
                "E",
                "Gaddb9/G#",
                "Am9",
                "Dm7",
                "Emb9/F"
              }
            },
            new()
            {
              Number = 75,
              Name = "Neo Soul",
              Chords = new List<string>
              {
                "CM7",
                "C#m7",
                "Dm7",
                "EbM7",
                "Em7",
                "FM7",
                "Gb7",
                "GM7",
                "AbM7",
                "Am7",
                "BbM7",
                "Bm7"
              }
            },
            new()
            {
              Number = 76,
              Name = "Neo-Soul",
              Chords = new List<string>
              {
                "CM7sus2",
                "Gadd9/B",
                "DM7sus2",
                "E6sus4/C#",
                "EM7sus2",
                "F#6sus4/D#",
                "F#M7sus2",
                "G#6sus4/F",
                "G#M7sus2",
                "A#6sus4/G",
                "A#M7sus2",
                "Fadd9/A"
              }
            },
            new()
            {
              Number = 77,
              Name = "Neo-Soul",
              Chords = new List<string>
              {
                "CM7",
                "C#m7",
                "DM7",
                "D#m7",
                "EM7",
                "Fm7",
                "F#M7",
                "Gm7",
                "AbM7",
                "Am7",
                "BbM7",
                "Bm7"
              }
            },
            new()
            {
              Number = 78,
              Name = "Neo-Soul",
              Chords = new List<string>
              {
                "C11sus",
                "A7/C#",
                "Dm7",
                "EbM7",
                "C7/E",
                "F6",
                "D7/F#",
                "Gdim7",
                "E7/G#",
                "F6/A",
                "Bb6",
                "Bm7b5"
              }
            },
            new()
            {
              Number = 79,
              Name = "Neo-Soul",
              Chords = new List<string>
              {
                "Ab/C",
                "Db",
                "Bb/D",
                "Ebm",
                "C/E",
                "Db/F",
                "Gb",
                "Eb/G",
                "Db/Ab",
                "F7/A",
                "Ebm/Bb",
                "B"
              }
            },
            new()
            {
              Number = 80,
              Name = "Neo-Soul",
              Chords = new List<string>
              {
                "Cm7b5",
                "Db7sus",
                "Bbadd2/D",
                "Ebm7",
                "EM7",
                "Fmb6",
                "GbM9",
                "Ebadd9/G",
                "Ab7sus",
                "AdimM7",
                "Bbm9",
                "Gb/B"
              }
            },
            new()
            {
              Number = 81,
              Name = "Neo-Soul",
              Chords = new List<string>
              {
                "C7alt",
                "DbM7add6",
                "Bb7/D",
                "Db/Eb",
                "Edim7",
                "Fm9",
                "Gb6/9",
                "Gm7b5",
                "Eb/Ab",
                "F7/A",
                "Bbm9",
                "BM7#11"
              }
            },
            new()
            {
              Number = 82,
              Name = "Jazz/Bossa",
              Chords = new List<string>
              {
                "Gm7",
                "Bb/Ab",
                "Am7",
                "C/Bb",
                "Bm7",
                "D/C",
                "C#m7",
                "E/D",
                "D#m7",
                "F#/E",
                "Fm7",
                "Ab/Gb"
              }
            },
            new()
            {
              Number = 83,
              Name = "Bossa Nova",
              Chords = new List<string>
              {
                "CM9",
                "C#dim",
                "Dm7",
                "D#dim",
                "CM9/E",
                "FM9",
                "F#dim",
                "Gm9",
                "C13b9",
                "F6",
                "BbM9",
                "G13b9"
              }
            },
            new()
            {
              Number = 84,
              Name = "Bossa Nova",
              Chords = new List<string>
              {
                "CM7",
                "C#Dim",
                "Dm11",
                "D#Dim",
                "Em11",
                "G/F",
                "F9#11",
                "Gsus13",
                "Abdim7",
                "FM7/A",
                "Bb13",
                "Eb/B"
              }
            },
            new()
            {
              Number = 85,
              Name = "Jazz",
              Chords = new List<string>
              {
                "CM7#11",
                "DbM7#11",
                "Dm9",
                "EbM7#11",
                "Em9",
                "FM7#11",
                "F#m11",
                "G6/9",
                "AbM7#11",
                "Am9",
                "BbM13",
                "Bm11b5"
              }
            },
            new()
            {
              Number = 86,
              Name = "Jazz",
              Chords = new List<string>
              {
                "CM9",
                "Db9#11",
                "Dm9",
                "D13b9/Eb",
                "Em11",
                "FM13",
                "E/F",
                "FM7/G",
                "Ab7#9#5",
                "Am9/11",
                "BbM9",
                "Bdim7"
              }
            },
            new()
            {
              Number = 87,
              Name = "Jazz",
              Chords = new List<string>
              {
                "Cmaj7",
                "Aadd9/C#",
                "Dm6",
                "B7/D#",
                "Em7",
                "Fmaj9",
                "Dadd9/F#",
                "Gm7/9",
                "Abmaj9",
                "Cadd9/G",
                "Eadd9/G#",
                "Asus7"
              }
            },
            new()
            {
              Number = 88,
              Name = "Jazz",
              Chords = new List<string>
              {
                "Fmaj7/9",
                "Gm7b5",
                "Abmaj7/9",
                "Bbm7b5",
                "Bmaj7/9",
                "C#m7b5",
                "DM7/9",
                "Em7b5",
                "CM7/9",
                "Dm7b5/9",
                "GbM7/9",
                "Abm7b5"
              }
            },
            new()
            {
              Number = 89,
              Name = "Jazz",
              Chords = new List<string>
              {
                "Cadd9",
                "C#dim7",
                "Gadd13/B",
                "D#dim#5",
                "FM7/E",
                "G7sus2/F",
                "D#dim7",
                "C6",
                "Ddim7",
                "Am/C",
                "Dm7b5",
                "G7/D"
              }
            },
            new()
            {
              Number = 90,
              Name = "Jazz",
              Chords = new List<string>
              {
                "Em7",
                "Edim7",
                "FM7",
                "F#dim7",
                "Em7",
                "C6/E",
                "F#dim7",
                "FM7b5",
                "Eb7/F",
                "Gadd9",
                "A#11/F",
                "F#dim7"
              }
            },
            new()
            {
              Number = 91,
              Name = "Jazz",
              Chords = new List<string>
              {
                "Gm7",
                "G#M7",
                "Am7",
                "A#M7",
                "G/B",
                "D#M7",
                "A#/D",
                "D",
                "CM7sus2",
                "Em7",
                "F6",
                "C6sus2b5"
              }
            },
            new()
            {
              Number = 92,
              Name = "Jazz",
              Chords = new List<string>
              {
                "A#M7",
                "BM7",
                "Cm7b5",
                "C#dim7",
                "Em7b5/D",
                "Fm7/D#",
                "Edim7",
                "F7/D#",
                "F#dim7",
                "Gm7/F",
                "G#M7/D#",
                "F7/D#"
              }
            },
            new()
            {
              Number = 93,
              Name = "Jazz",
              Chords = new List<string>
              {
                "A#M7/A",
                "G#6",
                "Am7",
                "A#M7",
                "Gadd11/B",
                "FM7/C",
                "A7/C",
                "D7/C",
                "D#M7b5/D",
                "Cadd9/D",
                "Fadd9",
                "Cdim7"
              }
            },
            new()
            {
              Number = 94,
              Name = "Jazz",
              Chords = new List<string>
              {
                "CM7",
                "DbM7",
                "Dm7",
                "Ebm7add13",
                "Em7b13",
                "Fm7",
                "F#m7b5",
                "G9sus",
                "G#dim7",
                "Am6",
                "F/Bb",
                "Bdim7"
              }
            },
            new()
            {
              Number = 95,
              Name = "Classical",
              Chords = new List<string>
              {
                "FM7/E",
                "Bdim/D",
                "Am",
                "G#dim7",
                "C/G",
                "Amb9/C",
                "Fadd9/C",
                "Dm",
                "C/G",
                "C/G",
                "Fadd9/G",
                "Ddim/G"
              }
            },
            new()
            {
              Number = 96,
              Name = "Classical",
              Chords = new List<string>
              {
                "Am",
                "Bm7/A",
                "Fdim/B",
                "C/E",
                "A7/G",
                "Dm7",
                "D#aug",
                "E",
                "F",
                "D/F#",
                "C/G",
                "E/G#"
              }
            },
            new()
            {
              Number = 97,
              Name = "Classical",
              Chords = new List<string>
              {
                "F#/C#",
                "F#/A#",
                "G#m7",
                "A6",
                "F#/C#",
                "Bsus2",
                "G#/C",
                "C#7",
                "A#7/D",
                "F#6sus4/C#",
                "C#m7",
                "C#7"
              }
            },
            new()
            {
              Number = 98,
              Name = "Classical",
              Chords = new List<string>
              {
                "Dm",
                "D#M7/D",
                "E7/D",
                "Dm7",
                "D7",
                "Gm/D",
                "G#/D",
                "A/D",
                "A#add9/D",
                "DM7(13)",
                "Csus2/D",
                "G#dim/D"
              }
            },
            new()
            {
              Number = 99,
              Name = "Modern",
              Chords = new List<string>
              {
                "CM13",
                "AM9/C#",
                "Dm13",
                "EbM13",
                "CM9/E",
                "FM13",
                "FmM13",
                "CM9(no 3)/G",
                "AbMb5#9",
                "Am11",
                "BbM9",
                "G6/9"
              }
            },
            new()
            {
              Number = 100,
              Name = "Modern",
              Chords = new List<string>
              {
                "CM9",
                "Cm9",
                "Dm9",
                "Dm6/9",
                "CM9/E",
                "Dm9/F",
                "D9/F#",
                "Gsus13",
                "G13b9",
                "Abmaj13",
                "AbDimM7",
                "BbM13"
              }
            }
          ];
  </script>

  <script type="text/csv" id="j6-chords-csv-data">
        SetNumber,ChordName,Notes
        1,Cadd9,"E4 D4 G3 C3"
        1,C#M9/C,"F4 D#4 C4 C#3"
        1,Dm7,"C4 A3 F4 D3"
        1,D#M7,"G4 D4 A#3 D#3"
        1,Cadd9/E,"G4 D4 C4 E3"
        1,FM9,"G4 E4 A3 F2"
        1,Dadd9/F#,"E4 D4 A3 F#2"
        1,Em7/G,"G4 E4 D4 G2"
        1,Fm6/G#,"F4 D4 C4 G#2"
        1,FM/A,"F4 C4 A3 A2"
        1,Gm/A#,"G4 D4 A#3 A#2"
        1,G/B,"G4 D4 B3 B2"
        2,CM9,"D4 B3 E3 C3"
        2,C#dim7,"E4 A#3 G3 C#3"
        2,Dm9,"E4 C4 F3 D3"
        2,D# dim7,"F#4 C4 A3 D#3"
        2,Em7,"G4 D4 B3 E3"
        2,FM9,"G4 E4 A3 F3"
        2,F#m7b5,"E4 C4 A3 F#3"
        2,F/A,"F4 C4 A3 G2"
        2,G# dim7,"F4 D4 B3 G#2"
        2,Am9,"G4 C4 B3 A2"
        2,C/A#,"E4 C4 G3 A#2"
        2,Bm7b5,"F4 D4 A3 B2"
        3,D7sus2/C,"D4 A3 E3 C3"
        3,C#7#9,"E4 B3 F3 C#3"
        3,Dm9,"E4 C4 F3 D3"
        3,D7#9,"F#4 C#4 G3 D#3"
        3,E7#9,"G4 D4 G#3 E3"
        3,FM9,"G4 E4 A3 F3"
        3,F#7#9,"A4 E4 A#3 F#3"
        3,G7(13),"E4 B3 F3 G2"
        3,G#7(13),"F4 C4 F#3 G#2"
        3,Am7(11),"D4 C4 G3 A2"
        3,A#9,"D4 C4 G#3 A#2"
        3,Bm7(11),"E4 D4 A3 B2"
        4,Dsus2/C,"D4 A3 E3 C3"
        4,C#7#9,"D#4 B3 F3 C#3"
        4,Dm9,"E4 C4 F3 D3"
        4,D#9,"F4 C#4 G3 D#3"
        4,Em9,"F#4 D4 G3 E3"
        4,Fm9,"G4 D#4 G#3 F2"
        4,F#m7b5,"E4 C4 A3 F#2"
        4,Gaug7,"D#4 B3 F3 G2"
        4,G#7(13),"F4 C4 F#3 G#2"
        4,Aaug7,"F4 C#4 G3 A2"
        4,A#7(13),"G4 D4 G#3 A#2"
        4,Bm7(11),"E4 D4 A3 B2"
        5,CM9,"D4 B3 E3 C3"
        5,C#M7,"D#4 C4 F3 C#3"
        5,DM9,"E4 C#4 F#3 D3"
        5,D#M9,"F4 D4 G3 D#3"
        5,EM9,"F#4 D#4 G#3 E3"
        5,FM9,"G4 E4 A3 F3"
        5,F#M9,"G#4 F4 A#3 F#3"
        5,GM9,"A4 F#4 B3 G3"
        5,G#M9,"A#4 G4 C4 G#3"
        5,AM9,"B4 G#4 C#4 A3"
        5,A#M9,"C5 A4 D4 A#3"
        5,BM9,"C#5 A#4 D#4 B3"
        6,C9,"E4 D4 A#3 C3"
        6,C#9,"D#4 B3 F3 C#3"
        6,D9,"E4 C4 F#3 D3"
        6,D#9,"F4 C#4 G3 D#3"
        6,E7#9,"G4 D4 G#3 E3"
        6,Fm9,"G4 D#4 A3 F2"
        6,F#dim7,"D#4 C4 A3 F#2"
        6,G7(13),"E4 B3 F3 G2"
        6,G#dim7,"F4 D4 B3 G#2"
        6,Aaug7,"F4 C#4 G3 A2"
        6,A#7(13),"G4 D4 G#3 A#2"
        6,Bm7b5,"F4 D4 A3 B2"
        7,C,"C5 G4 E4 C3"
        7,C#dim7,"A#4 G4 E4 C#3"
        7,Dm,"A4 F4 D4 D3"
        7,D#dim7,"C5 A4 F#4 D#3"
        7,Em,"B4 G4 E4 E3"
        7,F,"C5 A4 F4 F3"
        7,F#m7b5,"C5 A4 E4 F#3"
        7,G,"B4 G4 D4 G3"
        7,G#dim7,"B4 F4 D4 G#3"
        7,Am,"C5 A4 E4 A2"
        7,A#,"A#4 F4 D4 A#2"
        7,Bdim,"B4 F4 D4 B2"
        8,Cm,"C5 G4 D#4 C3"
        8,C#,"G#4 F4 C#4 C#3"
        8,Ddim,"G#4 F4 D4 D3"
        8,Eb,"A#4 G4 D#4 D#3"
        8,Edim7,"A#4 G4 C#4 E3"
        8,Fm,"G#4 F4 C4 F2"
        8,F#dim7,"A4 D#4 C4 F#2"
        8,Gm,"G4 D4 A#3 G2"
        8,G#,"G#4 D#4 C4 G#2"
        8,Am7b5,"G4 D#4 C4 A2"
        8,A#,"A#4 F4 D4 A#2"
        8,Bdim7,"G#4 F4 D4 B2"
        9,Cm,"C5 G4 D#4 C3"
        9,C#,"G#4 F4 C#4 C#3"
        9,Ddim,"G#4 F4 D4 D3"
        9,D#aug,"B4 G4 D#4 D#3"
        9,Em,"B4 G4 E4 E3"
        9,Fm,"G#4 F4 C4 F2"
        9,F#dim7,"A4 D#4 C4 F#2"
        9,G,"G4 D4 B3 G2"
        9,G#,"C4 D#4 G#4 G#2"
        9,Am7b5,"G4 D#4 C4 A2"
        9,A#,"A#4 F4 D4 A#2"
        9,Bdim,"B4 F4 D4 B2"
        10,Cmadd9,"G4 D#4 D4 C3"
        10,C#M7,"F4 C4 G#3 C#3"
        10,Dm7b5,"G#4 F4 C4 D3"
        10,D#M7,"G4 D4 A#3 D#3"
        10,Edim7,"G4 C#4 A#3 E3"
        10,Fm9,"G4 D#4 G#3 F2"
        10,F#dim7,"D#4 C4 A3 F#2"
        10,Gm7,"F4 D4 A#3 G2"
        10,G#M7,"G4 D#4 C4 G#2"
        10,Am7b5,"G4 D#4 C4 A2"
        10,G#/A#,"D#4 C4 G#3 A#2"
        10,Bdim7,"F4 D4 G#3 B2"
        11,Cmadd9,"G4 D#4 D4 C3"
        11,Gdim/C#,"G4 D#4 A#3 C#3"
        11,Dm7b5,"F4 C4 G#3 D3"
        11,D#M7,"G4 D4 A#3 D#3"
        11,EM9,"F#4 D#4 G#3 E3"
        11,Fm9,"G4 D#4 G#3 F2"
        11,F#dim7,"D#4 C4 A3 F#2"
        11,Gaug7,"D#4 B3 F3 G2"
        11,G#M7,"G4 D#4 C4 G#2"
        11,Am7b5,"G4 D#4 C4 A2"
        11,Cm7/A#,"G4 D#4 C4 A#2"
        11,Baug#9,"G4 D#4 D4 B2"
        12,Cm7(11),"F4 D#4 A#3 C3"
        12,C#7#9,"E4 B3 F3 C#3"
        12,Dm7b5,"G#4 F4 C4 D3"
        12,D#M7#5,"G4 D4 B3 D#3"
        12,E9,"F#4 D4 G#3 E2"
        12,F9,"G4 D#4 A3 F2"
        12,F#dim7,"D#4 C4 A3 F#2"
        12,G7#9,"A#4 F4 B3 G2"
        12,G#M7b5,"G4 D4 C4 G#2"
        12,Am7b5,"G4 D#4 C4 A2"
        12,A#m7,"F4 C#4 G#3 A#2"
        12,Bdim7,"F4 D4 G#3 B2"
        13,Cm9,"D4 A#3 D#3 C3"
        13,C#9,"D#4 B3 F3 C#3"
        13,Dm9,"E4 C4 F3 D3"
        13,D#9,"F4 C#4 G3 D#3"
        13,EM9,"F#4 D#4 G#3 E2"
        13,Fm9,"G4 D#4 G#3 F2"
        13,F#dim7,"D#4 C4 A3 F#2"
        13,G7(13),"E4 B3 F3 G2"
        13,G#m6,"F4 D#4 B3 G#2"
        13,Am7b5,"G4 D#4 C4 A2"
        13,A#m7,"F4 C#4 G#3 A#2"
        13,Bm7b5,"F4 D4 A3 B2"
        14,Coct,"C5 C4"
        14,C#oct,"C#5 C#4"
        14,Doct,"D5 D4"
        14,D#oct,"D#5 D#4"
        14,Eoct,"E5 E4"
        14,Foct,"F5 F4"
        14,F#oct,"F#5 F#4"
        14,Goct,"G5 G4"
        14,G#oct,"G#5 G#4"
        14,Aoct,"A5 A4"
        14,A#oct,"A#5 A#4"
        14,Boct,"B5 B4"
        15,C4th,"F4 C4"
        15,C#4th,"F#4 C#4"
        15,D4th,"G4 D4"
        15,D#4th,"G#4 D#4"
        15,E4th,"A4 E4"
        15,F4th,"A#4 F4"
        15,F#4th,"B4 F#4"
        15,G4th,"C5 G4"
        15,G#4th,"C#5 G#4"
        15,A4th,"D5 A4"
        15,A#4th,"D#5 A#4"
        15,B4th,"E5 B4"
        16,C5th,"G4 C4"
        16,C#5th,"G#4 C#4"
        16,D5th,"A4 D4"
        16,D#5th,"A#4 D#4"
        16,E5th,"B4 E4"
        16,F5th,"C5 F4"
        16,F#5th,"C#5 F#4"
        16,G5th,"D5 G4"
        16,G#5th,"D#5 G#4"
        16,A5th,"E5 A4"
        16,A#5th,"F5 A#4"
        16,B5th,"F#5 B4"
        17,C,"G3 E3 C3"
        17,C#,"G#3 F3 C#3"
        17,D,"A3 F#3 D3"
        17,D#,"A#3 G3 D#3"
        17,E,"B3 G#3 E3"
        17,F,"C4 A3 F3"
        17,F#,"C#4 A#3 F#3"
        17,G,"D4 B3 G3"
        17,G#,"D#4 C4 G#3"
        17,A,"E4 C#4 A3"
        17,A#,"F4 D4 A#3"
        17,B,"F#4 D#4 B3"
        18,Cm,"G3 D#3 C3"
        18,C#m,"G#3 E3 C#3"
        18,Dm,"A3 F3 D3"
        18,D#m,"A#3 F#3 D#3"
        18,E,"B3 G3 E3"
        18,Fm,"C4 G#3 F3"
        18,F#m,"C#4 A3 F#3"
        18,Gm,"D4 A#3 G3"
        18,G#m,"D#4 B3 G#3"
        18,Am,"E4 C4 A3"
        18,A#m,"F4 C#4 A#3"
        18,Bm,"F#4 D4 B3"
        19,CM7,"B3 G3 E3 C3"
        19,C#M7,"C4 G#3 F3 C#3"
        19,DM7,"C#4 A3 F#3 D3"
        19,D#M7,"D4 A#3 G3 D#3"
        19,EM7,"D#4 B3 G#3 E3"
        19,FM7,"E4 C4 A3 F3"
        19,F#FM7,"F4 C#4 A#3 F#3"
        19,GM7,"F#4 D4 B3 G3"
        19,G#M7,"G4 D#4 C4 G#3"
        19,AM7,"G#4 E4 C#4 A3"
        19,A#M7,"A4 F4 D4 A#3"
        19,BM7,"A#4 F#4 D#4 B3"
        20,Cm7,"A#3 G3 D#3 C3"
        20,C#m7,"B3 G#3 E3 C#3"
        20,Dm7,"C4 A3 F3 D3"
        20,D#m7,"C#4 A#3 F#3 D#3"
        20,Em7,"D4 B3 G3 E3"
        20,Fm7,"D#4 C4 G#3 F3"
        20,F#m7,"E4 C#4 A3 F#3"
        20,Gm7,"F4 D4 A#3 G3"
        20,G#m7,"F#4 D#4 B3 G#3"
        20,Am7,"G4 E4 C4 A3"
        20,A#m7,"G#4 F4 C#4 A#3"
        20,Bm7,"A4 F#4 D4 B3"
        21,CM9,"D4 B3 E3 C3"
        21,C#M9,"D#4 C4 F3 C#3"
        21,DM9,"E4 C#4 F#3 D3"
        21,D#M9,"F4 D4 G3 D#3"
        21,EM9,"F#4 D#4 G#3 E3"
        21,FM9,"G4 E4 A3 F3"
        21,F#M9,"G#4 F4 A#3 F#3"
        21,GM9,"A4 F#4 B3 G3"
        21,G#M9,"A#4 G4 C4 G#3"
        21,AM9,"B4 G#4 C#4 A3"
        21,A#M9,"C5 A4 D4 A#3"
        21,BM9,"C#5 A#4 D#4 B3"
        22,Cm9,"D4 A#3 D#3 C3"
        22,C#m9,"D#4 B3 E3 C#3"
        22,Dm9,"E4 C4 F3 D3"
        22,D#m9,"F4 C#4 F#3 D#3"
        22,Em9,"F#4 D4 G3 E3"
        22,Fm9,"G4 D#4 G#3 F3"
        22,F#m9,"G#4 E4 A3 F#3"
        22,Gm9,"A4 F4 A#3 G3"
        22,G#m9,"A#4 F#4 B3 G#3"
        22,Am9,"B4 G4 C4 A3"
        22,A#m9,"C5 G#4 C#4 A#3"
        22,Bm9,"C#5 A4 D4 B3"
        23,CM9/#11,"F#4 D4 B3 C3"
        23,C#M9/#11,"G4 D#4 C4 C#3"
        23,DM9/#11,"G#4 E4 C#4 D3"
        23,D#M9/#11,"A4 F4 D4 D#3"
        23,EM9/#11,"A#4 F#4 D#4 E3"
        23,FM9/#11,"B4 G4 E4 F3"
        23,F#M9/#11,"C5 G#4 F4 F#3"
        23,GM9/#11,"C#5 A4 F#4 G3"
        23,G#M9/#11,"D5 A#4 G4 G#3"
        23,AM9/#11,"D#5 B4 G#4 A3"
        23,A#M9/#11,"E5 C5 A4 A#3"
        23,BM9/#11,"F5 C#5 A#4 B3"
        24,Cm9/11,"F4 D4 A#3 C3"
        24,C#m9/11,"F#4 D#4 B3 C#3"
        24,Dm9/11,"G4 E4 C4 D3"
        24,D#m9/11,"G#4 F4 C#4 D#3"
        24,Em9/11,"A4 F#4 D4 E3"
        24,Fm9/11,"A#4 G4 D#4 F3"
        24,F#m9/11,"B4 G#4 E4 F#3"
        24,Gm9/11,"C5 A4 F4 G3"
        24,G#m9/11,"C#5 A#4 F#4 G#3"
        24,Am9/11,"D5 B4 G4 A3"
        24,A#m9/11,"D#5 C5 G#4 A#3"
        24,Bm9/11,"E5 C#5 A4 B3"
        25,CM7,"B3 G3 E3 C3"
        25,CM7,"C4 B3 G3 E3"
        25,CM7,"E4 C4 B3 G3"
        25,CM7,"G4 E4 C4 B3"
        25,CM7,"B4 G4 E4 C4"
        25,CM7,"C5 B4 G4 E4"
        25,CM7,"B4 E4 G3 C3"
        25,CM7,"C5 B4 E4 G3"
        25,CM7,"E5 B4 G4 C4"
        25,CM7,"G5 C5 B4 E4"
        25,CM7,"B5 E5 C5 G4"
        25,CM7,"C6 G5 E5 B4"
        26,Cm7,"A#3 G3 D#3 C3"
        26,Cm7/D#,"C4 A#3 G3 D#3"
        26,Cm7/G,"D#4 C4 A#3 G3"
        26,Cm7/A#,"G4 D#4 C4 A#3"
        26,Cm7,"A#4 G4 D#4 C4"
        26,Cm7/D#,"C5 A#4 G4 D#4"
        26,Cm7,"A#4 D#4 G3 C3"
        26,Cm7/G,"C5 A#4 D#4 G3"
        26,Cm7,"D#5 A#4 G4 C4"
        26,Cm7/D#,"G5 C5 A#4 D#4"
        26,Cm7/G,"A#5 D#5 C5 G4"
        26,Cm7/A#,"C6 G5 D#5 A#4"
        27,C,"E4 G3 C3"
        27,Em,"G4 B3 E3"
        27,G,"B4 D4 G3"
        27,Am,"C5 E4 A3"
        27,Bm,"D5 F#4 B3"
        27,C,"E5 G4 C4"
        27,Em,"G5 B4 E4"
        27,G,"B5 D5 G4"
        27,Am,"C6 E5 A4"
        27,Bm,"D6 F#5 B4"
        27,C,"E6 G5 C5"
        27,Em,"D7 B5 E5"
        28,C,"C4 G3 E3 C3"
        28,C7,"A#3 G3 E3 C3"
        28,Dm7,"C4 A3 F3 D3"
        28,D#M7,"A#3 G3 D3 D#2"
        28,C/E,"C4 G3 E3 E2"
        28,F,"C4 A3 F3 F2"
        28,Fm,"C4 G#3 F3 F2"
        28,G,"B3 G3 D3 G2"
        28,C/G,"C4 G3 E3 G2"
        28,Am7,"C4 G3 E3 A2"
        28,Eaug/A#,"C4 G#3 E3 A#2"
        28,G7/B,"B3 G3 F3 B2"
        29,C,"E4 C4 C3 C2"
        29,FM7,"E4 C4 F2 F1"
        29,G,"D4 B3 G2 G1"
        29,Em7,"D4 G3 B2 E2"
        29,Dm7,"C4 F3 A2 D2"
        29,CM7/E,"C4 G3 B2 E2"
        29,F,"C4 A3 C3 F2"
        29,D7/G,"D4 A3 C3 G2"
        29,G,"D4 B3 D3 G2"
        29,Am,"E4 C4 E3 A2"
        29,Dm,"F4 A3 A2 D2"
        29,G7,"G4 B3 F3 G2"
        30,Cm,"D#4 G3 C3"
        30,D#,"G4 A#3 D#3"
        30,G#,"C4 D#3 G#2"
        30,A#,"D4 F3 A#2"
        30,Gm,"G4 D4 A#3 G3"
        30,G#,"G#4 D#4 C4 G#3"
        30,D#,"G4 D#4 A#3 D#3"
        30,A#sus4/D,"F4 D#4 A#3 D3"
        30,Cm,"D#4 C4 G3 C3"
        30,G/B,"D4 B3 G3 B2"
        30,G#,"C4 G#3 D#3 G#2"
        30,F/A,"C4 A3 F3 A2"
        31,Cadd11,"C5 F4 E4 C3"
        31,Bb/C,"F4 D4 A#3 C3"
        31,Dm7,"F4 C4 A3 D3"
        31,D7,"F#4 C4 A3 D3"
        31,Cadd9/E,"G4 D4 C4 E3"
        31,FM7,"A4 E4 C4 F3"
        31,F7,"A4 D#4 C4 F3"
        31,Gm7,"A#4 F4 D4 G3"
        31,A/G,"A4 E4 C#4 G3"
        31,FM7/A,"C5 F4 E4 A3"
        31,F/Bb,"A4 F4 C4 A#3"
        31,G7/B,"G4 F4 D4 B3"
        32,Cmb13,"D#4 G#3 G3 C3"
        32,D#M7,"G4 D4 A#3 D#3"
        32,G7/D,"F4 B3 G3 D3"
        32,A#/D#,"F4 D4 A#3 D#3"
        32,C7,"E4 A#3 G3 C3"
        32,Fm7,"G#4 D#4 C4 F3"
        32,D#,"G4 D#4 A#3 D#3"
        32,Gm7,"F4 D4 A#3 G3"
        32,G#M9,"G4 C4 A#3 G#3"
        32,G#m6,"F4 D#3 B3 G#3"
        32,F7/A,"F4 D#4 C3 A3"
        32,A#add11,"A#4 D#4 D4 A#3"
        33,CM7,"B3 G3 E3 C3"
        33,F/E,"C4 A3 F3 E3"
        33,A#M7,"D4 A3 F3 A#2"
        33,G,"D4 B3 G3 G2"
        33,Dm7,"F4 C4 F3 D3"
        33,C,"E4 C4 G3 C3"
        33,A#M7,"F4 D4 A3 A#2"
        33,G,"G4 D4 B3 G2"
        33,C,"E4 C4 G3 C3"
        33,A/C#,"E4 C#4 A3 C#3"
        33,Dm,"F4 D4 A3 D3"
        33,G/F,"G4 D4 B3 F3"
        34,Csus2,"D4 G3 D3 C3"
        34,Dsus2,"E4 A3 E3 D3"
        34,D#sus2,"F4 A#3 F3 D#3"
        34,Fsus2,"G4 C4 G3 F3"
        34,Gsus2,"A4 D4 A3 G3"
        34,A#sus2,"C5 F4 C4 A#3"
        34,Csus2,"D5 G4 D4 C4"
        34,Dsus2,"E5 A4 E4 D4"
        34,D#sus2,"F5 A#4 F4 D#4"
        34,Fsus2,"G5 C5 G4 F4"
        34,Gsus2,"A5 D5 A4 G4"
        34,A#sus2,"C6 F5 C5 A#4"
        35,CM7,"B4 E4 G3 C3"
        35,Am7,"G4 C4 E3 A2"
        35,DM7,"C#5 F#4 A3 D3"
        35,Bm7,"A4 D4 F#3 B2"
        35,EM7,"D#5 G#4 B3 E3"
        35,C#m7,"B4 E4 G#3 C#3"
        35,F#M7,"F5 A#4 C#4 F#3"
        35,D#m7,"C#5 F#4 A#3 D#3"
        35,G#M7,"G5 C5 D#4 G#3"
        35,Fm7,"D#5 G#4 C4 F3"
        35,A#M7,"A5 D5 F4 A#3"
        35,Gm7,"F5 A#4 D4 G3"
        36,Ebsus2/C,"Eb4 Bb3 F3 C3"
        36,Fsus2/D,"F4 C4 G3 D3"
        36,Gsus2/E,"G4 D4 A3 E3"
        36,Absus2/F,"Ab4 Eb4 Bb3 F3"
        36,Bbsus2/G,"Bb4 F4 C4 G3"
        36,Csus2/A,"C5 G4 D4 A3"
        36,Dsus2/B,"D5 A4 E4 B3"
        36,Ebsus2/C,"Eb5 Bb4 F4 C4"
        36,Fsus2/D,"F5 C5 G4 D4"
        36,Gsus2/E,"G5 D5 A4 E4"
        36,Absus2/F,"Ab5 Eb5 Bb4 F4"
        36,Bbsus2/G,"Bb5 F5 C5 G4"
        37,C6sus2,"A4 D4 G3 C3"
        37,Dsus2,"A4 E4 A3 D3"
        37,Emadd11,"A4 G4 B3 E3"
        37,Dadd9/F#,"A4 E4 D4 F#3"
        37,Gadd9,"B4 A4 D4 G3"
        37,Am7/11,"D5 G4 C4 A3"
        37,Bm7,"D5 A4 F#4 B3"
        37,C6,"E5 A4 G4 C4"
        37,D6,"F#5 B4 A4 D4"
        37,Emadd9,"F#5 B4 G4 E4"
        37,E7sus4,"A5 D5 B4 E4"
        37,Em7b5/F,"G5 E5 D5 F4"
        38,C,"E4 C4 G3 C3"
        38,Gsus4,"G4 D4 C4 G3"
        38,G7sus4,"F4 D4 C4 G3"
        38,A#/D#,"F4 D4 A#3 D#3"
        38,C/E,"E4 C4 G3 E3"
        38,Gsus4/F,"D4 C4 G3 F3"
        38,D/F#,"F#4 D4 A3 F#3"
        38,C/G,"E4 C4 G3 G2"
        38,E/G#,"E4 B3 G#3 G#2"
        38,Am,"E4 C4 A3 A2"
        38,Fsus4,"F4 C4 A#3 F3"
        38,G,"G4 D4 B3 B2"
        39,C6sus4,"A3 G3 F3 C3"
        39,Gmadd9/D,"A#3 A3 G3 D3"
        39,Edim11,"A#3 A3 G3 E3"
        39,Fsus2/D,"C4 G3 F3 D3"
        39,BbM7,"D4 A#3 A3 F3"
        39,Gmadd9,"D4 A#3 A3 G3"
        39,Am/G,"E4 C4 A3 G3"
        39,C7/G,"E4 C4 A#3 G3"
        39,A#M7,"F4 D4 A#3 A3"
        39,Gm/A,"G4 D4 A#3 A3"
        39,C7/A#,"G4 E4 C4 A#3"
        39,A#m6,"G4 F4 C#4 A#3"
        40,Cadd9,"G3 E3 D3 C3"
        40,Dadd9,"A3 F#3 E3 D3"
        40,D#add9,"A#3 G3 F3 D#3"
        40,Fadd9,"C4 A3 G3 F3"
        40,Gadd9,"D4 B3 A3 G3"
        40,G#add9,"D#4 C4 A#3 G#3"
        40,A#add9,"F4 D4 C4 A#3"
        40,Cadd9,"G4 E4 D4 C4"
        40,Dadd9,"A4 F#4 E4 D4"
        40,D#add9,"A#4 G4 F4 D#4"
        40,Fadd9,"C5 A4 G4 F4"
        40,Gadd9,"D5 B4 A4 G4"
        41,C,"C4 G3 E3 C2"
        41,C#dim7,"A#3 G3 E3 C#2"
        41,Fsus2/D,"C4 G3 F3 D2"
        41,D#add9,"A#3 G3 F3 D#2"
        41,Csus2/E,"C4 G3 D3 E2"
        41,FM7,"C4 A3 E3 F2"
        41,F#dim,"C4 A3 F#3 F#2"
        41,Gsus4,"C4 G3 D3 G2"
        41,G#6,"C4 G#3 F3 G#2"
        41,Csus2/A,"C4 G3 D3 A2"
        41,Csus2/A#,"C4 G3 D3 A#2"
        41,G7/B,"B3 G3 F3 B2"
        42,C,"C5 E4 G3 C3"
        42,A#sus2/D#,"C5 F4 A#3 D#3"
        42,A#7/G#,"A#4 F4 G#3 G#2"
        42,G/B,"B4 D4 G3 B2"
        42,C,"C5 E4 G3 C3"
        42,Fm,"C5 F4 G#3 F2"
        42,F#dim7,"C5 D#4 A3 F#2"
        42,C,"C5 E4 G3 G2"
        42,G#add9,"C5 D#4 A#3 G#2"
        42,F/A,"C5 F4 A3 A2"
        42,A#,"D5 F4 A#3 A#2"
        42,G7/B,"D5 F4 G3 B2"
        43,Cm7,"G4 D#4 A#3 C3"
        43,A#/C,"F4 D4 A#3 C3"
        43,D#/G#,"G4 D#4 A#3 G#2"
        43,A#/G#,"F4 D4 A#3 G#2"
        43,D#/F,"G4 D#4 A#3 F3"
        43,A#/F,"F3 D4 A#3 F3"
        43,G#add9,"D#4 C4 A#3 G#2"
        43,A#,"F4 D4 A#3 A#2"
        43,G#M7,"D#4 C4 G3 G#2"
        43,Fsus2/A,"F4 C4 G3 A2"
        43,A#6,"F4 D4 G3 A#2"
        43,Fm7/B,"F4 D#4 G#3 B2"
        44,Cm7,"A#4 G4 D#4 C3"
        44,C#sus2/F,"G#4 D#4 C#4 F3"
        44,Gm7,"A#4 F4 D4 G3"
        44,D#,"A#4 D#4 G3 D#3"
        44,Csus2/E,"G4 D4 C4 E3"
        44,Fm,"G#4 F4 C4 F3"
        44,D#dim7,"A4 D#4 C4 F#3"
        44,G#sus2/G,"A#4 D#4 G#3 G3"
        44,Cm7,"A#4 D#4 C4 C3"
        44,F7,"A4 D#4 C4 F3"
        44,Fm7,"G#4 D#4 C4 F3"
        44,G5,"G4 D4 D3 G3"
        45,Ab,"Ab3 Eb3 C3"
        45,Fm,"Ab3 F3 C3"
        45,Gm,"Bb3 G3 D3"
        45,Ab,"C4 Ab3 Eb3"
        45,Fm,"C4 Ab3 F3"
        45,Bb,"D3 Bb3 F3"
        45,Gm,"D4 Bb3 G3"
        45,Cm,"Eb4 C4 G3"
        45,Ab,"Eb4 C4 Ab3"
        45,Fm,"F4 C4 Ab3"
        45,Bb,"F4 D4 Bb3"
        45,Cm,"G4 Eb4 C4"
        46,C,"E3 G2 C2"
        46,D,"F#3 A2 D2"
        46,Em,"G3 B2 E2"
        46,D,"A3 D3 F#2"
        46,G,"B3 D3 G2"
        46,Am,"C4 E3 A2"
        46,Bm,"D4 F#3 B2"
        46,C,"E4 G3 C3"
        46,D,"F#4 A3 D3"
        46,Em,"G4 B3 E3"
        46,D,"A4 D4 F#3"
        46,G,"B4 D4 G3"
        47,Cm7,"A#3 G3 D#3 C3"
        47,D#M7,"D4 A#3 G3 D#3"
        47,Dm7,"C4 A3 F3 D3"
        47,Fm7,"D#4 C4 G#3 F3"
        47,D#M7,"D4 A#3 G3 D#3"
        47,Gm7,"F4 D4 A#3 G3"
        47,Fm7,"D#4 C4 G#3 F3"
        47,G#M7,"G4 D#4 C4 G#3"
        47,Gm7,"F4 D4 A#3 G3"
        47,A#7,"G#4 F4 D4 A#3"
        47,G#M7,"G4 D#4 C4 G#3"
        47,C#/C,"G#4 F4 C#4 C4"
        48,Cm,"Eb4 G3 C3 C2"
        48,Ab/C,"Eb4 Ab3 C3 C2"
        48,Bb/D,"F4 Bb3 F3 D2"
        48,Eb,"G4 Bb3 Bb2 Eb2"
        48,C/E,"G4 C4 G3 E2"
        48,Fm,"Ab4 C4 F3 F2"
        48,F,"A4 C4 F3 F2"
        48,Gm,"Bb4 D4 G3 G2"
        48,Ab,"C4 Eb3 Ab2 Ab1"
        48,F7/A,"C4 F3 Eb3 A1"
        48,Bb,"D4 F3 Bb2 Bb1"
        48,G7/B,"D4 G3 F3 B1"
        49,Cm7,"Eb4 Bb3 G3 C3"
        49,C#m7,"E4 B3 G#3 C#3"
        49,Dm7,"F4 C4 A3 D3"
        49,EbM7,"G4 D4 Bb3 Eb3"
        49,Gm/E,"G4 D4 Bb3 E3"
        49,Eb/F,"G4 Eb4 Bb3 F3"
        49,D7/F#,"C4 A3 D3 F#2"
        49,Gm7,"Bb3 F3 D3 G2"
        49,AbM7,"C4 G3 Eb3 Ab2"
        49,Ab/Bb,"Eb4 C4 Ab3 Bb2"
        49,BbM7,"D4 A3 F3 Bb2"
        49,Bm7b5,"D4 A3 F3 B2"
        50,Cmaj7,"E4 B3 G3 C3"
        50,Dmaj7,"F#4 C#4 A3 D3"
        50,Em7,"G4 D4 B3 E3"
        50,Fmaj9,"G4 E4 C4 F3"
        50,Gmaj9,"A4 F#4 D4 G3"
        50,Eadd9/G#,"B4 F#4 E4 G#3"
        50,Am7,"C5 G4 E4 A3"
        50,Bm7,"D5 A4 F#4 B3"
        50,Cmaj9,"D5 B4 G4 C4"
        50,Dm7/9,"E5 C5 F4 D4"
        50,Em7,"G5 D5 B4 E4"
        50,Fmaj7,"A5 E5 C5 F4"
        51,Cm7,"A#3 G3 D#3 C3"
        51,G#/C#,"C4 G#3 D#3 C#3"
        51,Dm7,"C4 A3 F3 D3"
        51,A#/D#,"D4 A#3 F3 D#3"
        51,Em7,"D4 B3 G3 E3"
        51,C/F,"E4 C4 G3 F3"
        51,F#m7,"E4 C#4 A3 F#3"
        51,D/G,"F#4 D4 A3 G3"
        51,G#m7,"F#4 D#4 B3 G#3"
        51,E/A,"G#4 E4 B3 A3"
        51,A#m7,"G#4 F4 C#4 A#3"
        51,F#/B,"A#4 F#4 C#4 B3"
        52,Cm7,"A#4 D#4 G3 C3"
        52,G#M7,"G4 C4 D#3 G#2"
        52,Dm7,"C5 F4 A3 D3"
        52,A#M7,"A4 D4 F3 A#2"
        52,Em7,"D5 G4 B3 E3"
        52,CM7,"B4 E4 G3 C3"
        52,F#m7,"E5 A4 C#4 F#3"
        52,DM7,"C#5 F#4 A3 D3"
        52,G#m7,"F#5 B4 D#4 G#3"
        52,EM7,"D#5 G#4 B3 E3"
        52,A#m7,"G#5 C#5 F4 A#3"
        52,F#M7,"F5 A#4 C#4 F#3"
        53,Cm7/11,"F4 A#3 D#3 C3"
        53,Cdim7,"F#4 A3 D#3 C3"
        53,C#M7/b5,"G4 C4 F3 C#3"
        53,Ddim7,"G#4 B3 F3 D3"
        53,Cm,"G4 C4 G3 D#3"
        53,C#M7,"F4 C4 F3 C#3"
        53,CM7,"E4 B3 G3 C3"
        53,Em7,"G4 D4 B3 E3"
        53,FM7,"A4 E4 C4 F3"
        53,Fm6,"G#4 D4 C4 F3"
        53,Csus2/E,"G4 D4 C4 E3"
        53,Fm,"F4 C4 G#3 F3"
        54,CM7,"B3 G3 E3 C3"
        54,Em7,"D4 B3 G3 E3"
        54,Dm7,"C4 A3 F3 D3"
        54,FM7,"E4 C4 A3 F3"
        54,D#M7,"D4 A#3 G3 D#3"
        54,Gm7,"F4 D4 A#3 G3"
        54,FM7,"E4 C4 A3 F3"
        54,Am7,"G4 E4 C4 A3"
        54,Gm7,"F4 D4 A#3 G3"
        54,A#M7,"A4 F4 D4 A#3"
        54,Am7,"G4 E4 C4 A3"
        54,Bm7,"A4 F#4 D4 B3"
        55,CM13,"B4 A4 E4 C4"
        55,CM7#5,"B4 G#4 E4 C4"
        55,Dm7b5,"C5 Ab4 F4 D4"
        55,G7,"B4 G4 F4 D4"
        55,Cadd9/E,"D5 C5 G4 E4"
        55,Fadd9,"C5 A4 G4 F4"
        55,FmAdd9,"C5 Ab4 G4 F4"
        55,G9,"F5 B4 A4 G4"
        55,E7/G#,"E5 D5 B4 G#4"
        55,Am9/11,"B5 D5 C5 A4"
        55,Gm11/Bb,"G5 D5 C5 Bb4"
        55,CM7#5/G#,"E5 C5 B4 G#4"
        56,Cm7,"Eb5 Bb4 C4 G3"
        56,Db6,"F5 Bb4 Db4 Ab3"
        56,Dm7,"F5 C5 D4 A3"
        56,Dm7b5,"F5 C5 D4 Ab3"
        56,EbM7,"G5 D5 Eb4 Bb3"
        56,Fm7,"Ab5 Eb5 F4 C4"
        56,Gb6,"Bb5 Eb5 Gb4 Db4"
        56,Gm7,"Bb5 F5 G4 D4"
        56,Ab6,"C6 F5 Ab4 Eb4"
        56,AbM7,"C6 G5 Ab4 Eb4"
        56,Am7,"C6 G5 A4 E4"
        56,BbM7,"D6 A5 Bb4 F4"
        57,C5b9,"C4 G3 C#3 C3"
        57,DbM7,"C4 G#3 F3 C#3"
        57,Dm7,"C4 A3 F3 D3"
        57,Ebsus11,"C#4 A#3 G#3 D#3"
        57,EM7#11,"D#4 A#3 G#3 E3"
        57,Fm9,"C4 G#3 G3 F3"
        57,GbM7#11,"F4 C3 A#3 F#3"
        57,Gm7,"F4 D3 A#3 G3"
        57,AbM7#11,"G4 D4 C4 G#3"
        57,A7alt,"G4 C#4 C4 A3"
        57,Bb5add9/b13,"F4 C4 F#3 A#2"
        57,C7sus4,"A#3 G3 F3 C3"
        58,Cm7,"G4 D#4 A#3 C3"
        58,A#m/C#,"F4 C#4 A#3 C#3"
        58,A#/D,"F4 D4 A#3 D3"
        58,D#,"G4 D#4 A#3 D#3"
        58,C/E,"G4 E4 C4 E2"
        58,Cm/F,"G4 D#4 C4 F2"
        58,D/F#,"A4 F#4 D4 F#2"
        58,G,"G4 D4 B3 G2"
        58,G#M7,"G4 D#4 C4 G#2"
        58,Csus4/A,"G4 F4 C4 A2"
        58,D#/A#,"G4 D#4 A#3 A#2"
        58,G/B,"G4 D4 B3 B2"
        59,CM9,"B3 A3 D3 C3"
        59,C6,"F#3 B3 E3 D#3"
        59,Dm9,"C#4 B3 E3 D3"
        59,Dm6,"G#4 C#4 F#3 F3"
        59,EM9,"D#4 C#4 F#3 E3"
        59,FM9,"E4 D4 G3 F3"
        59,F6,"B4 E4 A3 G#3"
        59,GM9,"F#4 E4 A3 G3"
        59,G6,"C#4 F#4 B3 A#3"
        59,Am9,"G#5 F#4 B3 A3"
        59,Am6,"D#5 G#4 C#4 C4"
        59,Bm9,"A#5 G#4 C#4 B3"
        60,CM13(no 3),"B3 A3 D3 C3"
        60,EM9(no 3),"F#4 B3 E3 D#3"
        60,DM13(no 3),"C#4 B3 E3 D3"
        60,F#M9(no 3),"G#4 C#4 F#3 F3"
        60,EM13(no 3),"D#4 C#4 F#3 E3"
        60,FM13(no3),"E4 D4 G3 F3"
        60,AM9(no3),"B4 E4 A3 G#3"
        60,GM13(no3),"F#4 E4 A3 G3"
        60,BM9(no3),"C#5 F#4 B3 A#3"
        60,AM13(no3),"G#4 F#4 B3 A3"
        60,C#M9(no 3),"D#5 G#4 C#4 C4"
        60,BM13(no3),"A#4 G#4 C#4 B3"
        61,Csus9/13,"A4 D4 G3 C3"
        61,C6,"E5 A4 G3 C3"
        61,Dsus9/13,"B4 E4 A3 D3"
        61,D6,"F#5 B4 A3 D3"
        61,Esus9/13,"C#5 F#4 B3 E3"
        61,Fsus9/13,"D5 G4 C4 F3"
        61,F6,"A4 D5 C4 F3"
        61,Gsus9/13,"E5 A4 D4 G3"
        61,G6,"B4 E4 D4 G3"
        61,Asus9/13,"F#5 B4 E4 A3"
        61,A6,"C#5 F#4 E4 A3"
        61,Bsus9/13,"G#5 C#5 F#4 B3"
        62,CM13,"E4 B3 A3 C3"
        62,C#sus9,"D#4 A#3 F#3 C#3"
        62,DM13,"F#4 C#4 B3 D3"
        62,D#sus9,"F4 A#3 G#3 D#3"
        62,EM13,"G#4 D#4 C#4 E3"
        62,FM13,"A4 E4 D4 F3"
        62,F#sus9&nbsp;,"G#4 C#4 B3 F#3"
        62,GMaj13,"B4 F#4 E4 G3"
        62,Absus9,"A#4 D#4 C#4 G#3"
        62,AM13,"C#5 G#4 F#4 A3"
        62,Bbsus9,"C5 F4 D#4 A#3"
        62,BM13,"D#5 A#4 G#4 B3"
        63,CM7,"E4 B3 C3 G2"
        63,Dbm7,"E4 B3 C#3 G#2"
        63,Dm7,"F4 C4 D3 A2"
        63,Eb6,"G4 C4 D#3 A#2"
        63,Em7,"G4 D4 E3 B2"
        63,FM7,"A4 E4 F3 C3"
        63,Gbm7,"A4 E4 F#3 C#3"
        63,GM7,"B4 F#4 G3 D3"
        63,Abm7,"B4 F#4 G#3 D#3"
        63,Am7,"C5 G4 A3 E3"
        63,Bb6,"D5 G4 B3 F3"
        63,Bm7,"D5 A4 B3 F#3"
        64,C6,"E4 A3 G3 C3"
        64,AM7,"E4 A3 G#3 C#3"
        64,D6,"F#4 B3 A3 D3"
        64,BM7,"F#4 B3 A#3 D#3"
        64,E6,"G#4 C#4 B3 E3"
        64,F6,"A4 D4 C4 F3"
        64,DM7,"A4 D4 C#4 F#3"
        64,G6,"B4 E4 D4 G3"
        64,EM7,"B4 E4 D#4 G#3"
        64,A6,"C#5 F#4 E4 A3"
        64,GbM7,"C#5 F#4 F4 A#3"
        64,B6,"D#5 G#4 F#4 B3"
        65,G/C,"G4 D4 B3 C3"
        65,C#dim7,"G4 E4 A#3 C#3"
        65,Dm7b5,"F4 C4 Ab3 D3"
        65,D#dim7,"F#4 C4 A3 D#3"
        65,Em7,"G4 D4 B3 E3"
        65,Fm11,"Eb4 Bb3 Ab3 F2"
        65,F#dim7,"D#4 A3 C3 F#2"
        65,Gm7b13,"Eb4 Bb3 F3 G2"
        65,G#M9,"G4 C4 A#3 G#2"
        65,Am7/b13,"F4 C3 G3 A2"
        65,A#m7 add 13,"G4 C#4 G#3 A#2"
        65,Bm7/b13,"G4 D3 A3 B2"
        66,Cm7/b13,"F4 Bb3 Ab3 C3"
        66,C#M13,"F4 C4 A#3 C#3"
        66,Dm7/b13,"F4 C4 Bb3 D3"
        66,D#m11,"F#4 C#4 G#3 D#3"
        66,D/E,"F#4 D4 A3 E3"
        66,G#m/F,"G#4 D#4 B3 F3"
        66,F#6,"A#4 D#4 C#4 F#3"
        66,A#m/G,"A#4 F4 C#4 G3"
        66,G#m11,"B4 F#4 C#4 G#3"
        66,AM9,"B4 E4 C#4 A3"
        66,A#7/b13,"G#4 F#4 D4 A#3"
        66,F#/B,"A#4 F#4 C#4 B3"
        67,D,"D4 A3 F#3 D2"
        67,C/D,"C4 G3 E3 D2"
        67,D/E,"D4 A3 F#3 E2"
        67,Dm/F,"D4 A3 F3 F2"
        67,Dsus2/F#,"D4 A3 E3 F#2"
        67,Gadd9,"D4 B3 A3 G2"
        67,E/G#,"E4 B3 G#3 G#2"
        67,A,"E4 C#4 A3 A1"
        67,A#dim7,"C#4 G3 E3 A#1"
        67,Bm7,"D4 A3 F#3 B1"
        67,D/C,"D4 A3 F#3 C2"
        67,C#dim,"C#4 G3 E3 C#2"
        68,Cmadd9,"D#4 D4 G3 C3"
        68,Abadd9/C,"D#4 A#3 G#3 C3"
        68,Bb7/D,"F4 A#3 G#3 D3"
        68,EbM9,"D4 G3 F3 D#3"
        68,Eb7/b9,"C#4 G3 E3 D#3"
        68,Fm9,"D#4 G#3 G3 F3"
        68,GbM6/9,"D#4 A#3 G#3 F#3"
        68,Gm7,"F4 D4 A#3 G3"
        68,Eb/Ab,"G4 D#4 A#3 G#3"
        68,Fsus4/A,"F4 C4 A#3 A3"
        68,Bbsus,"F4 D#4 D4 A#3"
        68,Bbsus4/b9,"A#4 D#4 B3 A#3"
        69,Ab7/C,"G#3 F#3 D#3 C3"
        69,C#m11,"B3 F#3 E3 C#3"
        69,DM9,"C#4 F#3 E3 D3"
        69,Bsus4/Eb,"B3 F#3 E3 D#3"
        69,EM add2,"B3 G#3 F#3 E3"
        69,DM7#11,"C#4 G#3 F#3 D3"
        69,F#m11,"E3 B2 A2 F#2"
        69,G6,"E3 B2 A2 G2"
        69,Abm7,"F#3 D#3 B2 G#2"
        69,AM7add6,"G#3 F#3 C#3 A2"
        69,F#add9/A#,"G#3 F#3 C#3 A#2"
        69,BM add4,"F#3 E3 D#3 B2"
        70,C9,"D4 Bb3 E3 C2"
        70,C/D,"E4 C4 G3 D2"
        70,D7b9,"Eb4 C4 F#3 D2"
        70,EbM7,"D4 Bb3 G3 Eb2"
        70,Em7b13,"D4 C4 G3 E2"
        70,Eb/F,"Eb4 Bb3 G3 F2"
        70,F#13,"Eb4 Bb3 E3 F#2"
        70,G7,"D4 B3 F3 G2"
        70,Abm6 add b13,"E4 B3 F3 Ab2"
        70,Am7,"E4 C4 G3 A2"
        70,Bm7,"F#4 D4 A3 B2"
        70,B7,"F#4 D#4 A3 B2"
        71,C7alt,"Eb4 Ab3 E3 C3"
        71,DbM7,"F4 C4 Ab3 Db3"
        71,D7alt,"F4 C4 F#3 D3"
        71,Eb7,"G4 Db4 Bb3 Eb3"
        71,C7/E,"G4 C4 Bb3 E3"
        71,F7alt,"Ab4 Eb4 A3 F3"
        71,F11sus2,"G4 Eb4 Bb3 F3"
        71,Gm7b5,"F4 Db4 Bb3 G3"
        71,Ab9,"Bb4 Gb4 C4 Ab3"
        71,Bb9sus,"Ab4 Eb4 C4 Bb3"
        71,Bb7add9,"Ab4 D4 C4 Bb3"
        71,C11sus2,"D4 Bb3 F3 C3"
        72,Cm9,"D4 A#3 D#3 C3"
        72,AbM7,"C4 G#3 G3 D#3"
        72,Dm7,"C4 A3 F3 D3"
        72,EbDimM7,"D4 A3 F#3 D#3"
        72,EbM7,"D4 A#3 G3 D#3"
        72,Fm7,"D#4 C4 G#3 F3"
        72,CM7#5,"E4 C4 G#3 G3"
        72,Gm7,"F4 D4 A#3 G3"
        72,G7#5,"F4 D#4 B3 G3"
        72,AbM7,"G4 D#4 C4 G#3"
        72,Fm7b5/B,"G#4 F4 D#4 B3"
        72,Bb13/D,"G4 A#3 G#3 D3"
        73,Cm7,"Bb4 G4 Eb4 C4"
        73,C#dim7,"A#4 G4 E4 C#4"
        73,Fm7,"Ab4 F4 Eb4 C4"
        73,Fm7/b5,"Ab4 F4 Eb4 B3"
        73,EbM7,"Bb4 G4 Eb4 D4"
        73,Cm7/Eb,"C5 Bb4 G4 Eb4"
        73,Edim,"Db5 Bb4 G4 E4"
        73,AbM7,"C5 Ab4 G4 Eb4"
        73,Fm7,"Eb5 C5 Ab4 F4"
        73,AbM13,"F5 C5 Ab4 G4"
        73,Bb13,"G5 D5 Bb4 Ab4"
        73,Bb6,"G5 F5 D5 Bb4"
        74,Em7/D,"B3 G3 E3 D3"
        74,Gm7b5/C#,"A#3 G3 F3 C#3"
        74,FM7/E,"C4 A3 F3 E3"
        74,DMb7/D#,"D4 A3 F#3 D#3"
        74,GM7/F#,"D4 B3 G3 F#3"
        74,Edim7,"C#4 A#3 G3 E3"
        74,Cadd13/E,"C4 A3 G3 E3"
        74,E,"E4 B3 G#3 E3"
        74,Gaddb9/G#,"G4 D4 B3 G#3"
        74,Am9,"G4 C4 B3 A3"
        74,Dm7,"F4 C4 F3 D3"
        74,Emb9/F,"E4 B3 G3 F3"
        75,CM7,"B4 E4 C4 G3"
        75,C#m7,"B4 E4 C#4 G#3"
        75,Dm7,"C5 F4 D4 A3"
        75,EbM7,"D5 G4 Eb4 Bb3"
        75,Em7,"D5 G4 E4 B3"
        75,FM7,"E5 A4 F4 C4"
        75,Gb7,"E5 Bb4 Gb4 Db4"
        75,GM7,"F#5 B4 G4 D4"
        75,AbM7,"G5 C5 Ab4 Eb4"
        75,Am7,"G5 C5 A4 E4"
        75,BbM7,"A5 D5 Bb4 F4"
        75,Bm7,"A5 D5 B4 F#4"
        76,CM7sus2,"B3 G3 D3 C3"
        76,Gadd9/B,"D4 A3 G3 B2"
        76,DM7sus2,"C#4 A3 E3 D3"
        76,E6sus4/C#,"E4 B3 A3 C#3"
        76,EM7sus2,"D#4 B3 F#3 E3"
        76,F#6sus4/D#,"F#4 C#4 B3 D#3"
        76,F#M7sus2,"F4 C#4 G#3 F#3"
        76,G#6sus4/F,"G#4 D#4 C#4 F3"
        76,G#M7sus2,"G4 D#4 A#3 G#3"
        76,A#6sus4/G,"A#4 F4 D#4 G3"
        76,A#M7sus2,"A4 F4 C4 A#3"
        76,Fadd9/A,"C5 G4 F4 A3"
        77,CM7,"E4 B3 G3 C3"
        77,C#m7,"E4 B3 G#3 C#3"
        77,DM7,"F#4 C#4 A3 D3"
        77,D#m7,"F#4 C#4 A#3 D#3"
        77,EM7,"G#4 D#4 B3 E3"
        77,Fm7,"G#4 D#4 C4 F3"
        77,F#M7,"A#4 F4 C#4 F#3"
        77,Gm7,"A#4 F4 D4 G3"
        77,AbM7,"C5 G4 D#4 G#3"
        77,Am7,"C5 G4 E4 A3"
        77,BbM7,"D5 A4 F4 A#3"
        77,Bm7,"D5 A4 F#4 B3"
        78,C11sus,"Bb4 F4 D4 C4"
        78,A7/C#,"A4 E4 G3 C#3"
        78,Dm7,"F4 C4 A3 D3"
        78,EbM7,"D4 Bb3 G3 Eb3"
        78,C7/E,"C4 Bb3 G3 E3"
        78,F6,"D4 C4 A3 F3"
        78,D7/F#,"D4 C4 A3 F#3"
        78,Gdim7,"E4 Db4 Bb3 G3"
        78,E7/G#,"E4 D4 B3 G#3"
        78,F6/A,"F4 D4 C4 A3"
        78,Bb6,"G4 F4 D4 Bb3"
        78,Bm7b5,"A4 F4 D4 B3"
        79,Ab/C,"Ab3 Eb3 C3"
        79,Db,"Ab3 F3 Db3"
        79,Bb/D,"Bb3 F3 D3"
        79,Ebm,"Bb3 Gb3 Eb3"
        79,C/E,"C4 G3 E3"
        79,Db/F,"Db4 Ab3 F3"
        79,Gb,"Db4 Bb3 Gb3"
        79,Eb/G,"Eb4 Bb3 G3"
        79,Db/Ab,"F4 Db4 Ab3"
        79,F7/A,"F4 Eb4 A3"
        79,Ebm/Bb,"Gb4 Eb4 Bb3"
        79,B,"F#4 D#4 B3"
        80,Cm7b5,"D#4 A#3 F#3 C3"
        80,Db7sus,"F#4 D#4 B3 C#3"
        80,Bbadd2/D,"F4 C4 A#3 D3"
        80,Ebm7,"F#4 C#4 A#3 D#3"
        80,EM7,"G#4 D#4 B3 E3"
        80,Fmb6,"G#4 C#4 C4 F3"
        80,GbM9,"F4 C#4 G#3 F#3"
        80,Ebadd9/G,"F4 D#4 A#3 G3"
        80,Ab7sus,"F#4 C#4 A#3 G#3"
        80,AdimM7,"G#4 D#4 C4 A3"
        80,Bbm9,"G#4 C#4 C4 A#3"
        80,Gb/B,"A#4 F#4 C#4 B3"
        81,C7alt,"Eb3 Ab3 E3 C3"
        81,DbM7add6,"C4 Bb3 F3 Db3"
        81,Bb7/D,"Bb3 Ab3 F3 D3"
        81,Db/Eb,"Ab3 F3 Db3 Eb2"
        81,Edim7,"G3 Db3 Bb2 E2"
        81,Fm9,"G3 Eb3 Ab2 F2"
        81,Gb6/9,"Ab3 Eb3 Bb2 Gb2"
        81,Gm7b5,"C4 F3 Db3 G2"
        81,Eb/Ab,"Bb3 G3 Eb3 Ab2"
        81,F7/A,"C4 F3 Eb3 A2"
        81,Bbm9,"C4 F3 Db3 Bb2"
        81,BM7#11,"Bb3 F3 Eb3 B2"
        82,Gm7,"D4 Bb3 F3 G2"
        82,Bb/Ab,"D4 Bb3 F3 Ab2"
        82,Am7,"E4 C4 G3 A2"
        82,C/Bb,"E4 C4 G3 Bb2"
        82,Bm7,"F#4 D4 A3 B2"
        82,D/C,"F#4 D4 A3 C3"
        82,C#m7,"G#4 E4 B3 C#3"
        82,E/D,"G#4 E4 B3 D3"
        82,D#m7,"A#4 F#4 C#4 D#3"
        82,F#/E,"A#4 F#4 C#4 E3"
        82,Fm7,"C5 Ab4 Eb4 F3"
        82,Ab/Gb,"C5 Ab4 Eb4 Gb3"
        83,CM9,"D5 B4 E4 C4"
        83,C#dim,"E5 A#4 G4 C#4"
        83,Dm7,"F5 C5 A4 D4"
        83,D#dim,"B5 F#5 C5 D#4"
        83,CM9/E,"G5 D5 C5 E4"
        83,FM9,"G5 E5 A4 F4"
        83,F#dim,"A5 D#5 C5 F#4"
        83,Gm9,"A5 F5 Bb4 G4"
        83,C13b9,"A5 E5 Db5 C4"
        83,F6,"A5 D5 C5 F4"
        83,BbM9,"C6 A5 D5 Bb4"
        83,G13b9,"E5 B4 Ab4 G3"
        84,CM7,"E5 B4 G4 C4"
        84,C#Dim,"G5 E5 A#4 C#4"
        84,Dm11,"G5 F5 C5 D4"
        84,D#Dim,"A5 F#5 C5 D#4"
        84,Em11,"A5 G5 D5 E4"
        84,G/F,"B5 G5 D5 F4"
        84,F9#11,"B5 G5 Eb5 F4"
        84,Gsus13,"E5 C5 F4 G3"
        84,Abdim7,"E5 B4 F4 Ab3"
        84,FM7/A,"E5 C5 F4 A3"
        84,Bb13,"G5 D5 Ab4 Bb3"
        84,Eb/B,"G5 Eb5 Bb4 B3"
        85,CM7#11,"B4 F#4 E4 C3"
        85,DbM7#11,"C5 G4 F4 Db3"
        85,Dm9,"E5 G4 F4 D3"
        85,EbM7#11,"D5 A4 G4 Eb3"
        85,Em9,"F#5 A4 G4 E3"
        85,FM7#11,"E5 B4 A4 F3"
        85,F#m11,"E5 B4 A4 F#3"
        85,G6/9,"A5 E5 B4 G3"
        85,AbM7#11,"G5 D5 C5 Ab3"
        85,Am9,"B5 D5 C5 A3"
        85,BbM13,"G5 D5 A4 Bb3"
        85,Bm11b5,"E5 A4 F4 B3"
        86,CM9,"B4 E4 D4 C3"
        86,Db9#11,"Bb4 F4 B3 Db3"
        86,Dm9,"C5 F4 E4 D3"
        86,D13b9/Eb,"B4 Gb4 C4 Eb3"
        86,Em11,"A4 G4 D4 E3"
        86,FM13,"A4 E4 D4 F3"
        86,E/F,"B4 G#4 E4 F3"
        86,FM7/G,"E5 A4 F4 G3"
        86,Ab7#9#5,"B5 E5 C5 Ab3"
        86,Am9/11,"B5 D5 C5 A3"
        86,BbM9,"A5 D5 C5 Bb3"
        86,Bdim7,"G5 D5 Ab4 B3"
        87,Cmaj7,"E4 B3 G3 C3"
        87,Aadd9/C#,"E4 B3 A3 C#3"
        87,Dm6,"F4 B3 A3 D3"
        87,B7/D#,"F#4 B3 A3 D#3"
        87,Em7,"G4 D4 B3 E3"
        87,Fmaj9,"G4 E4 A3 F3"
        87,Dadd9/F#,"A4 E4 D4 F#3"
        87,Gm7/9,"A4 F4 Bb3 G3"
        87,Abmaj9,"Bb4 G4 C4 Ab3"
        87,Cadd9/G,"B4 E4 C4 G3"
        87,Eadd9/G#,"B4 F#4 E4 G#3"
        87,Asus7,"D5 B4 G4 A3"
        88,Fmaj7/9,"C4 A3 G3 E3"
        88,Gm7/b5,"Db4 Bb3 G3 F3"
        88,Abmaj7/9,"Eb4 C4 Bb3 G3"
        88,Bbm7/b5,"E4 Db4 Bb3 Ab3"
        88,Bmaj7/9,"F#4 D#4 C#4 A#3"
        88,C#m7/b5,"G4 E4 C#4 B3"
        88,DM7/9,"A4 F#4 E4 C#4"
        88,Em7/b5,"A#4 G4 E4 D4"
        88,CM7/9,"B4 G4 E4 D4"
        88,Dm7b5/9,"C5 Ab4 F4 E4"
        88,GbM7/9,"Db5 Bb4 Ab4 F4"
        88,Abm7/b5,"D5 B4 Ab4 Gb4"
        89,Cadd9,"G4 E4 D4 C4"
        89,C#dim7,"A#4 G4 E4 C#4"
        89,Gadd13/B,"G4 E4 D4 B3"
        89,D#dim#5,"B4 A4 F#4 D#4"
        89,FM7/E,"C5 A4 F4 E4"
        89,G7sus2/F,"D5 A4 G4 F4"
        89,D#dim7,"C5 A4 F#4 D#4"
        89,C6,"A4 G4 E4 C4"
        89,Ddim7,"B4 G#4 F4 D4"
        89,Am/C,"C5 A4 E4 C4"
        89,Dm7b5,"C5 G#4 F4 D4"
        89,G7/D,"B4 G4 F4 D4"
        90,Em7,"D4 B3 G3 E3"
        90,Edim7,"C#4 A#3 G3 E3"
        90,FM7,"E4 C4 A3 F3"
        90,F#dim7,"D#4 C4 A3 F#3"
        90,Em7,"D4 B3 G3 E3"
        90,C6/E,"C4 A3 G3 E3"
        90,F#dim7,"D#4 C4 A3 F#3"
        90,FM7b5,"E4 B3 A3 F3"
        90,Eb7/F,"E4 B3 G#3 F3"
        90,Gadd9,"D4 B3 A3 G3"
        90,A#11/F,"E4 D4 A#3 F3"
        90,F#dim7,"D#4 C4 A3 F#3"
        91,Gm7,"D4 A#3 F3 G2"
        91,G#M7,"D#4 C4 G3 G#2"
        91,Am7,"E4 C4 G3 A2"
        91,A#M7,"F4 D4 A3 A#2"
        91,G/B,"D4 G3 B2"
        91,D#M7,"D4 A#3 G3 D#3"
        91,A#/D,"D4 A#3 G3 D#3"
        91,D,"D4 A3 F#3 D3"
        91,CM7sus2,"D4 B3 G3 C3"
        91,Em7,"D4 B3 G3 E3"
        91,F6,"D4 C4 A3 F3"
        91,C6sus2b5,"D4 A3 F#3 C3"
        92,A#M7,"A3 F3 D3 A#2"
        92,BM7,"A#3 F#3 D#3 B2"
        92,Cm7b5,"A#3 F#3 D#3 C3"
        92,C#dim7,"A#3 G3 E3 C#3"
        92,Em7b5/D,"A#3 G3 E3 D3"
        92,Fm7/D#,"C4 G#3 F3 D#3"
        92,Edim7,"C#4 A#3 G3 E3"
        92,F7/D#,"C4 A3 F3 D#3"
        92,F#dim7,"D#4 C4 A3 F#3"
        92,Gm7/F,"D4 A#3 G3 F3"
        92,G#M7/D#,"C4 G#3 G3 D#3"
        92,F7/D#,"C4 A3 F3 D#3"
        93,A#M7/A,"F3 D3 A#2 A2"
        93,G#6,"F3 D#3 C3 G#2"
        93,Am7,"G3 E3 C3 A2"
        93,A#M7,"A3 F3 D3 A#2"
        93,Gadd11/B,"G3 D3 C3 B2"
        93,FM7/C,"A3 F3 E3 C3"
        93,A7/C,"A3 G3 E3 C#3"
        93,D7/C,"A3 F#3 D3 C3"
        93,D#M7b5/D,"A3 G3 D#3 D3"
        93,Cadd9/D,"C4 G3 E3 D3"
        93,Fadd9,"C4 A3 G3 F3"
        93,Cdim7,"A3 F#3 D#3 C3"
        94,CM7,"B4 E4 G3 C3"
        94,DbM7,"C5 F4 G#3 C#3"
        94,Dm7,"C5 F4 A3 D3"
        94,Ebm7add13,"C5 F#4 C#4 D#3"
        94,Em7/b13,"C5 G4 D4 E3"
        94,Fm7,"C5 G#4 D#4 F3"
        94,F#m7/b5,"C5 A4 E4 F#3"
        94,G9sus,"A4 F4 C4 G3"
        94,G#dim7,"B4 F4 D4 G#3"
        94,Am6,"C5 F#4 E4 A3"
        94,F/Bb,"A4 F4 C4 A#2"
        94,Bdim7,"G#4 D4 F3 B2"
        95,FM7/E,"A4 F4 E4"
        95,Bdim/D,"B4 F4 D4"
        95,Am,"C5 E4 A3"
        95,G#dim7,"D5 F4 B3 G#3"
        95,C/G,"E5 E4 C4 G4"
        95,Amb9/C,"A5 A#4 E4 C4"
        95,Fadd9/C,"G5 A4 F4 C4"
        95,Dm,"F5 A4 F4 D3"
        95,C/G,"E5 G4 C4 G2"
        95,C/G,"C5 E4 G3 G2"
        95,Fadd9/G,"A4 F4 C4 G2"
        95,Ddim/G,"G#4 F4 D4 G2"
        96,Am,"E4 C4 A3 A2"
        96,Bm7/A,"D4 B3 A3 A2"
        96,Fdim/B,"F4 B3 G#3 B2"
        96,C/E,"E4 C4 G3 E3"
        96,A7/G,"E4 C#4 A3 G3"
        96,Dm7,"F4 C4 A3 D3"
        96,D#aug,"D#4 B3 G3 D#3"
        96,E,"E4 B3 G#3 E3"
        96,F,"F4 C4 A3 F3"
        96,D/F#,"D4 A3 F#3 F#2"
        96,C/G,"E4 C4 G3 G2"
        96,E/G#,"E4 B3 G#3 G#2"
        97,F#/C#,"F#4 A#3 F#3 C#3"
        97,F#/A#,"F#4 C#4 F#3 A#2"
        97,G#m7,"F#4 B3 F#3 G#2"
        97,A6,"F#4 C#4 E3 A2"
        97,F#/C#,"F#4 C#4 F#3 A#2"
        97,Bsus2,"F#4 C#4 F#3 B2"
        97,G#/C,"G#4 D#4 G#3 C3"
        97,C#7,"F4 B3 G#3 C#3"
        97,A#7/D,"F4 A#3 G#3 D3"
        97,F#6sus4/C#,"D#4 B3 F#3 C#3"
        97,C#m7,"E4 B3 G#3 C#3"
        97,C#7,"F4 B3 F3 C#3"
        98,Dm,"D4 A3 F3 D2"
        98,D#M7/D,"D#4 A#3 G3 D2"
        98,E7/D,"B3 G#3 E3 D2"
        98,Dm7,"C4 A3 F3 D2"
        98,D7,"C4 A3 F#3 D2"
        98,Gm/D,"D4 A#3 G3 D2"
        98,G#/D,"D#4 C4 G#3 D2"
        98,A/D,"E4 C#4 A3 D2"
        98,A#add9/D,"F4 C4 A#3 D2"
        98,DM7(13),"F#4 C#4 B3 D2"
        98,Csus2/D,"G4 D4 C4 D2"
        98,G#dim/D,"G#4 D4 B3 D2"
        99,CM13,"B3 A3 E3 C3"
        99,AM9/C#,"B3 A3 E3 C#3"
        99,Dm13,"C4 B3 F3 D3"
        99,EbM13,"D4 C4 G3 D#3"
        99,CM9/E,"D4 C4 G3 E3"
        99,FM13,"E4 D4 A3 F3"
        99,FmM13,"E4 D4 G#3 F3"
        99,CM9 (no3)/G,"B4 D4 C4 G3"
        99,AbMb5/#9,"B4 D4 C4 G#3"
        99,Am11,"D4 G3 C3 A2"
        99,BbM9,"D4 A3 C3 A#2"
        99,G6/9,"E4 A3 G3 B2"
        100,CM9,"B4 E4 D4 C3"
        100,Cm9,"Bb4 Eb4 D4 C3"
        100,Dm9,"C5 F4 E4 D3"
        100,Dm6/9,"B4 F4 E4 D3"
        100,CM9/E,"B4 D4 C4 E3"
        100,Dm9/F,"C5 E4 D4 F3"
        100,D9/F#,"C5 E4 D4 F#3"
        100,Gsus13,"E5 A4 F4 G3"
        100,G13b9,"E5 Ab4 F4 G3"
        100,AbMaj13,"E5 Bb4 G4 Ab3"
        100,AbDimM7,"G5 B4 F4 Ab3"
        100,BbM13,"A5 D5 G4 Bb3"
  </script>

  <script>
    const noteOrder = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    const flatToSharp = { Db: "C#", Eb: "D#", Gb: "F#", Ab: "G#", Bb: "A#" };

    const searchBox = document.getElementById("search");
    const clearBtn = document.getElementById("clear");
    const resultsHost = document.getElementById("results");
    const resultSummary = document.getElementById("resultSummary");
    const browserHost = document.getElementById("browser");

    const rawData = document.getElementById("chord-data").textContent;
    const chordSets = parseChordSets(rawData).map((set, index) => ({ id: index, ...set }));
    const browserState = new Map(chordSets.map(set => [set.id, 0]));
    const octaveState = new Map(chordSets.map(set => [set.id, 0]));
    const noteSourceState = new Map(chordSets.map(set => [set.id, 'j6']));

    function parseChordSets(raw) {
      let text = raw.trim();
      text = text.replace(/^return\s+/i, "");
      text = text.replace(/;?\s*$/g, "");
      text = text.replace(/Chords\s*=\s*new List<string>\s*{([\s\S]*?)}/g, "Chords = [$1]");
      text = text.replace(/new\(\)\s*{/g, "{");
      text = text.replace(/Number\s*=/g, '"number":');
      text = text.replace(/Name\s*=/g, '"name":');
      text = text.replace(/Chords\s*=/g, '"chords":');
      text = text.replace(/=/g, ":");
      text = text.replace(/,\s*]/g, "]");
      text = text.replace(/,\s*}/g, "}");
      const jsonReady = text.replace(/([[{,]\s*)([A-Za-z0-9_]+)\s*:/g, '$1"$2":');
      return JSON.parse(jsonReady);
    }

    function normalizeNote(note) {
      return flatToSharp[note] || note;
    }

    function transposeNote(note, semitones) {
      const normalized = normalizeNote(note);
      const idx = noteOrder.indexOf(normalized);
      if (idx === -1) return note;
      let next = (idx + semitones) % 12;
      if (next < 0) next += 12;
      return noteOrder[next];
    }

    function extractNote(token) {
      if (!token) return "";
      if (token.length >= 2 && (token[1] === "#" || token[1] === "b")) {
        return token.slice(0, 2);
      }
      return token[0];
    }

    function transposeChord(chord, semitones) {
      const [base, slash] = chord.split("/");
      const root = extractNote(base);
      const suffix = base.slice(root.length);
      const newRoot = transposeNote(root, semitones) + suffix;

      if (!slash) return newRoot;
      const bassRoot = extractNote(slash);
      const bassSuffix = slash.slice(bassRoot.length);
      const newBass = transposeNote(bassRoot, semitones) + bassSuffix;
      return `${newRoot}/${newBass}`;
    }

    function globToRegex(glob) {
      const escaped = glob.replace(/[.+^${}()|[\]\\]/g, "\\$&");
      const regex = "^" + escaped.replace(/\*/g, ".*").replace(/\?/g, ".") + "$";
      return new RegExp(regex, "i");
    }

    function isMatch(chord, glob) {
      return globToRegex(glob).test(chord);
    }

    function search() {
      const terms = searchBox.value
        .split(/[\s,]+/)
        .map(t => t.trim())
        .filter(Boolean);

      const results = [];
      if (terms.length === 0) {
        renderResults(results);
        return;
      }

      for (const set of chordSets) {
        for (let k = 0; k < 12; k++) {
          const transposed = set.chords.map(ch => transposeChord(ch, k));
          const ok = terms.every(term => transposed.some(ch => isMatch(ch, term)));
          if (ok) {
            results.push({ ...set, transposition: k, transposed });
          }
        }
      }

      renderResults(results);
    }

    function renderResults(results) {
      if (results.length === 0) {
        resultsHost.innerHTML = `<p class="empty">No matches yet. Type chords above to search (supports * and ? globs).</p>`;
        resultSummary.textContent = "";
        return;
      }

      resultSummary.textContent = `${results.length} progression${results.length === 1 ? "" : "s"}`;
      resultsHost.innerHTML = results.map(r => cardHtml(r, r.transposed, r.transposition, false)).join("");
    }

    function renderBrowser() {
      const cards = chordSets.map(set => {
        const k = browserState.get(set.id) ?? 0;
        const transposed = set.chords.map(ch => transposeChord(ch, k));
        return cardHtml(set, transposed, k, true);
      });
      browserHost.innerHTML = cards.join("");
    }

    function changeOctave(id, delta) {
      const current = octaveState.get(id) ?? 0;
      const next = Math.max(-3, Math.min(3, current + delta));
      if (current === next) return;
      octaveState.set(id, next);

      const displays = document.querySelectorAll(`.octave-val[data-id="${id}"]`);
      displays.forEach(el => {
        el.textContent = (next > 0 ? '+' : '') + next;
      });
    }

    function cardHtml(set, chords, transposition, includeTransposer) {
      const header = `<div class="card-header">
          <div><strong>${set.number}</strong> ‚Ä¢ ${set.name}</div>
          <span class="badge">+${transposition} st</span>
        </div>`;

      const noteSource = noteSourceState.get(set.id) ?? 'j6';
      const isJ6 = noteSource === 'j6';
      const toggleHtml = `<label class="note-source-toggle">
          <span class="toggle-label${isJ6 ? ' active' : ''}">J6</span>
          <input type="checkbox" class="note-source-switch" data-id="${set.id}"${!isJ6 ? ' checked' : ''} />
          <span class="toggle-label${!isJ6 ? ' active' : ''}">Int</span>
        </label>`;

      const slider = includeTransposer
        ? `<div>
            <input class="transposer" type="range" min="0" max="11" value="${transposition}" data-id="${set.id}" />
            <div class="transposer-info">
              ${toggleHtml}
            </div>
          </div>`
        : `<div class="transposer-info" style="justify-content:flex-end">${toggleHtml}</div>`;

      // Piano key layout:
      // White keys (indices): C=0, D=2, E=4, F=5, G=7, A=9, B=11
      // Black keys (indices): C#=1, D#=3, F#=6, G#=8, A#=10
      const whiteKeyIndices = [0, 2, 4, 5, 7, 9, 11];
      const blackKeyIndices = [1, 3, null, 6, 8, 10, null]; // null = no black key in that slot

      const whiteKeys = whiteKeyIndices.map(i => 
        `<div class="white-key" data-chord-index="${i}"><span class="chord-label">${chords[i]}</span></div>`
      ).join("");

      const blackKeys = blackKeyIndices.map(i => 
        i !== null 
          ? `<div class="black-key-slot"><div class="black-key" data-chord-index="${i}"><span class="chord-label">${chords[i]}</span></div></div>`
          : `<div class="black-key-slot"><div class="black-key"></div></div>`
      ).join("");

      const keyboard = `<div class="keyboard" data-keyboard-id="${set.id}" data-set-number="${set.number}" data-transposition="${transposition}">
        <div class="white-keys">${whiteKeys}</div>
        <div class="black-keys">${blackKeys}</div>
      </div>`;

      const octave = octaveState.get(set.id) ?? 0;
      const octaveDisplay = (octave > 0 ? '+' : '') + octave;

      const switcher = `<div class="octave-switcher">
        <button class="octave-btn up" onclick="changeOctave(${set.id}, 1)" aria-label="Octave Up">‚ñ≤</button>
        <div class="octave-val" data-id="${set.id}">${octaveDisplay}</div>
        <button class="octave-btn down" onclick="changeOctave(${set.id}, -1)" aria-label="Octave Down">‚ñº</button>
      </div>`;

      return `<div class="card" data-card-id="${set.id}">
        ${header}
        ${slider}
        <div class="keyboard-wrapper">
          ${keyboard}
          ${switcher}
        </div>
      </div>`;
    }

    function updateKeyboard(id, chords) {
      const keyboard = browserHost.querySelector(`[data-keyboard-id="${id}"]`);
      const badge = browserHost.querySelector(`[data-card-id="${id}"] .badge`);
      if (!keyboard) return;

      const whiteKeyIndices = [0, 2, 4, 5, 7, 9, 11];
      const blackKeyIndices = [1, 3, null, 6, 8, 10, null];

      const whiteKeys = whiteKeyIndices.map(i => 
        `<div class="white-key" data-chord-index="${i}"><span class="chord-label">${chords[i]}</span></div>`
      ).join("");

      const blackKeys = blackKeyIndices.map(i => 
        i !== null 
          ? `<div class="black-key-slot"><div class="black-key" data-chord-index="${i}"><span class="chord-label">${chords[i]}</span></div></div>`
          : `<div class="black-key-slot"><div class="black-key"></div></div>`
      ).join("");

      keyboard.innerHTML = `<div class="white-keys">${whiteKeys}</div><div class="black-keys">${blackKeys}</div>`;

      const k = browserState.get(id) ?? 0;
      keyboard.dataset.transposition = k;
      if (badge) badge.textContent = `+${k} st`;
    }

    browserHost.addEventListener("input", evt => {
      const target = evt.target;
      if (target.classList.contains("transposer")) {
        const id = Number(target.dataset.id);
        const value = Number(target.value);
        browserState.set(id, value);
        const set = chordSets.find(s => s.id === id);
        if (set) {
          const transposed = set.chords.map(ch => transposeChord(ch, value));
          updateKeyboard(id, transposed);
        }
      }
    });

    document.addEventListener('change', evt => {
      if (evt.target.classList.contains('note-source-switch')) {
        const id = Number(evt.target.dataset.id);
        const mode = evt.target.checked ? 'int' : 'j6';
        noteSourceState.set(id, mode);
        document.querySelectorAll(`.note-source-switch[data-id="${id}"]`).forEach(sw => {
          sw.checked = evt.target.checked;
          const label = sw.closest('.note-source-toggle');
          if (label) {
            const labels = label.querySelectorAll('.toggle-label');
            labels[0].classList.toggle('active', !sw.checked);
            labels[1].classList.toggle('active', sw.checked);
          }
        });
      }
    });

    searchBox.addEventListener("input", search);
    clearBtn.addEventListener("click", () => {
      searchBox.value = "";
      search();
    });

    renderBrowser();
    search();

    /* ‚îÄ‚îÄ Chord Playback ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

    /* Exact MIDI notes from the Roland J-6 manual, loaded from j6-chords.csv (set number -> chord index -> MIDI notes). */
    let _exactNotes = {};
    loadExactNotesFromCsv();

    async function loadExactNotesFromCsv() {
      const embedded = document.getElementById('j6-chords-csv-data');
      if (embedded) {
        _exactNotes = parseExactNotesCsv(embedded.textContent);
        return;
      }
      try {
        const res = await fetch('j6-chords.csv');
        if (!res.ok) throw new Error(`Failed to load j6-chords.csv (${res.status})`);
        const text = await res.text();
        _exactNotes = parseExactNotesCsv(text);
      } catch (err) {
        console.error('Could not load exact chord notes from CSV', err);
      }
    }

    function parseExactNotesCsv(text) {
      const lines = text.trim().split(/\r?\n/);
      const result = {};
      for (let i = 1; i < lines.length; i++) { // skip header
        const line = lines[i].trim();
        if (!line) continue;

        const match = line.match(/^\s*(\d+)\s*,\s*([^,]+)\s*,\s*"?([^"]+?)"?\s*$/);
        if (!match) continue;

        const setNumber = Number(match[1]);
        const notesPart = match[3].trim();
        const tokens = notesPart.split(/\s+/).filter(Boolean);
        const midi = tokens.map(_noteWithOctaveToMidi).filter(n => n !== null);
        if (!result[setNumber]) result[setNumber] = [];
        result[setNumber].push(midi);
      }
      return result;
    }

    function _noteWithOctaveToMidi(token) {
      const m = token.trim().match(/^([A-G])(#{1}|b{1})?(\d)$/);
      if (!m) return null;
      const noteName = normalizeNote(`${m[1]}${m[2] || ''}`);
      const octave = Number(m[3]);
      const semitone = noteOrder.indexOf(noteName);
      if (semitone < 0 || Number.isNaN(octave)) return null;
      return semitone + (octave + 1) * 12;
    }

    /* Interval-based fallback for sets without exact data */
    const _noteVal = { C:0,'C#':1,Db:1,D:2,'D#':3,Eb:3,E:4,F:5,'F#':6,Gb:6,G:7,'G#':8,Ab:8,A:9,'A#':10,Bb:10,B:11 };

    const _qualityIntervals = {
      '':       [0,4,7],
      'M':      [0,4,7],
      'maj':    [0,4,7],
      'm':      [0,3,7],
      'min':    [0,3,7],
      'dim':    [0,3,6],
      'Dim':    [0,3,6],
      'aug':    [0,4,8],
      'sus2':   [0,2,7],
      'sus4':   [0,5,7],
      'sus':    [0,5,7],
      '5':      [0,7],
      'oct':    [0,12],
      '4th':    [0,5],
      '5th':    [0,7],

      '6':       [0,4,7,9],
      'm6':      [0,3,7,9],
      '6/9':     [0,4,7,9,14],
      'M6/9':    [0,4,7,9,14],
      'm6/9':    [0,3,7,9,14],
      '6sus2':   [0,2,7,9],
      '6sus4':   [0,5,7,9],
      '6sus2b5': [0,2,6,9],

      '7':       [0,4,7,10],
      'M7':      [0,4,7,11],
      'maj7':    [0,4,7,11],
      'm7':      [0,3,7,10],
      'dim7':    [0,3,6,9],
      'm7b5':    [0,3,6,10],
      'aug7':    [0,4,8,10],
      'M7#5':    [0,4,8,11],
      '7sus4':   [0,5,7,10],
      '7sus2':   [0,2,7,10],
      '7sus':    [0,5,7,10],
      'sus7':    [0,5,7,10],
      'dimM7':   [0,3,6,11],
      'DimM7':   [0,3,6,11],
      '7#5':     [0,4,8,10],
      '7#9':     [0,4,7,10,15],
      '7#9#5':   [0,4,8,10,15],
      '7(13)':   [0,4,7,10,21],
      '7add9':   [0,4,7,10,14],
      '7alt':    [0,4,6,10,13],
      '7b13':    [0,4,7,10,20],
      '7b9':     [0,4,7,10,13],
      'M7#11':   [0,4,7,11,18],
      'M7(13)':  [0,4,7,11,21],
      'M7add6':  [0,4,7,9,11],
      'M7b5':    [0,4,6,11],
      'M7sus2':  [0,2,7,11],
      'M7/9':    [0,4,7,11,14],
      'maj7/9':  [0,4,7,11,14],

      '9':       [0,4,7,10,14],
      'M9':      [0,4,7,11,14],
      'maj9':    [0,4,7,11,14],
      'm9':      [0,3,7,10,14],
      'add9':    [0,4,7,14],
      'madd9':   [0,3,7,14],
      'mAdd9':   [0,3,7,14],
      'add2':    [0,2,4,7],
      'Madd2':   [0,2,4,7],
      'Madd4':   [0,4,5,7],
      '9#11':    [0,4,7,10,14,18],
      '9sus':    [0,5,7,10,14],
      'sus9':    [0,5,7,10,14],
      'M9#11':   [0,4,7,11,14,18],
      'M9(no 3)':[0,7,11,14],
      'm9/11':   [0,3,7,10,14,17],
      'm7/9':    [0,3,7,10,14],
      'm7b5/9':  [0,3,6,10,14],

      '11':      [0,4,7,10,14,17],
      'm11':     [0,3,7,10,14,17],
      'add11':   [0,4,7,17],
      'madd11':  [0,3,7,17],
      '11sus':   [0,5,7,10,17],
      '11sus2':  [0,2,7,10,17],
      'sus11':   [0,5,7,10,17],
      'm11b5':   [0,3,6,10,14,17],
      'm7(11)':  [0,3,7,10,17],
      'm7/11':   [0,3,7,10,17],
      'dim11':   [0,3,6,9,17],

      '13':      [0,4,7,10,14,21],
      'M13':     [0,4,7,11,14,21],
      'maj13':   [0,4,7,11,14,21],
      'm13':     [0,3,7,10,14,21],
      'mM13':    [0,3,7,11,14,21],
      'M13(no 3)':[0,7,11,14,21],
      '13b9':    [0,4,7,10,13,21],
      'add13':   [0,4,7,9],
      'sus13':   [0,5,7,10,21],
      'sus9/13': [0,5,7,10,14,21],
      'm7add13': [0,3,7,10,21],
      'm7b13':   [0,3,7,10,20],

      'aug#9':   [0,4,8,10,15],
      'addb9':   [0,4,7,13],
      'mb9':     [0,3,7,13],
      'mb6':     [0,3,7,8],
      'mb13':    [0,3,7,20],
      'Mb7':     [0,4,7,10],
      'Mb5#9':   [0,4,6,15],
      '5b9':     [0,7,13],
      '5add9b13':[0,7,14,20],
      'sus4b9':  [0,5,7,13],
      'dim#5':   [0,3,8],
      'm6addb13':[0,3,7,9,20],
      'm7add6':  [0,3,7,9,10],
    };

    function _extractNoteName(s) {
      if (!s) return null;
      if (s.length >= 2 && (s[1] === '#' || s[1] === 'b')) return s.slice(0,2);
      if (s[0] >= 'A' && s[0] <= 'G') return s.slice(0,1);
      return null;
    }

    function _noteToMidi(noteName) {
      const n = normalizeNote(noteName);
      return _noteVal[n] ?? null;
    }

    function _parseChordNotes(chordName) {
      if (!chordName) return null;

      /* separate slash‚Äëchord bass */
      let main = chordName, bassName = null;
      const si = chordName.lastIndexOf('/');
      if (si > 0) {
        const afterSlash = chordName.slice(si + 1);
        const bn = _extractNoteName(afterSlash);
        if (bn && bn.length === afterSlash.length && _noteToMidi(bn) !== null) {
          bassName = bn;
          main = chordName.slice(0, si);
        }
      }

      /* root */
      const root = extractNote(main);
      if (!root) return null;
      const rootVal = _noteToMidi(root);
      if (rootVal === null) return null;

      const quality = main.slice(root.length);
      let intervals = _qualityIntervals[quality];
      if (!intervals) intervals = [0,4,7]; /* fallback: major triad */

      /* build MIDI notes ‚Äì root at C3 (48) */
      const base = 48 + rootVal;
      let notes = intervals.map(i => base + i);

      /* bass note for slash chords */
      if (bassName) {
        const bv = _noteToMidi(bassName);
        if (bv !== null) {
          let bm = 36 + bv;           /* start at C2 */
          while (bm >= notes[0]) bm -= 12;
          if (bm < 36) bm += 12;
          /* remove duplicate from chord body if present */
          notes = notes.filter(n => n % 12 !== bm % 12);
          notes = [bm, ...notes];
        }
      }

      return notes;
    }

    function _getNotesForKey(key) {
      const keyboard = key.closest('.keyboard');
      if (!keyboard) return null;

      const chordIndex = parseInt(key.dataset.chordIndex, 10);
      if (isNaN(chordIndex)) return null;

      const setNumber = parseInt(keyboard.dataset.setNumber, 10);
      const keyboardId = parseInt(keyboard.dataset.keyboardId, 10);
      const transposition = parseInt(keyboard.dataset.transposition, 10) || 0;

      const octave = !isNaN(keyboardId) ? (octaveState.get(keyboardId) ?? 0) : 0;
      const octaveShift = octave * 12;

      /* Use exact notes from the J-6 manual when available and J6 mode is selected */
      const source = !isNaN(keyboardId) ? (noteSourceState.get(keyboardId) ?? 'j6') : 'j6';
      if (source === 'j6') {
        const setNotes = _exactNotes[setNumber];
        if (setNotes && setNotes[chordIndex]) {
          return setNotes[chordIndex].map(n => n + transposition + octaveShift);
        }
      }

      /* Fallback: parse chord name using interval table */
      const label = key.querySelector('.chord-label');
      if (!label || !label.textContent.trim()) return null;
      const notes = _parseChordNotes(label.textContent.trim());
      if (notes) {
        return notes.map(n => n + octaveShift);
      }
      return null;
    }

    /* ‚îÄ‚îÄ Web Audio playback ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    const _synthDefaults = {
      wave: 'sawtooth',
      unisonVoices: 1,
      unisonDetune: 10,
      attack: 0.03,
      decay: 1.00,
      sustain: 0,
      release: 1.01,
      filterCutoff: 2943,
      filterQ: 6.3,
      filterAttack: 0,
      filterDecay: 0.29,
      filterSustain: 0,
      filterRelease: 1.01,
      ampEnvEnabled: true,
      filterEnabled: true,
      filterEnvEnabled: true,
      lfoEnabled: true,
      lfoTarget: 'cutoff',
      lfoWave: 'sine',
      lfoRate: 2.0,
      lfoDepth: 0.5
    };

    const _synthPresets = {
      // ‚îÄ‚îÄ Plucks ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      classicPluck: {
        wave: 'sawtooth',
        attack: 0.001,
        decay: 0.3,
        sustain: 0,
        release: 0.1,
        filterCutoff: 3500,
        filterQ: 2.5,
        filterAttack: 0.001,
        filterDecay: 0.2,
        filterSustain: 0,
        filterRelease: 0.1,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.5
      },
      brightPluck: {
        wave: 'triangle',
        attack: 0.001,
        decay: 0.15,
        sustain: 0,
        release: 0.05,
        filterCutoff: 8000,
        filterQ: 1.5,
        filterAttack: 0.001,
        filterDecay: 0.1,
        filterSustain: 0,
        filterRelease: 0.05,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.5
      },
      softPluck: {
        wave: 'sine',
        attack: 0.01,
        decay: 0.4,
        sustain: 0,
        release: 0.15,
        filterCutoff: 2000,
        filterQ: 1.0,
        filterAttack: 0.01,
        filterDecay: 0.3,
        filterSustain: 0,
        filterRelease: 0.15,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.5
      },
      metallicPluck: {
        wave: 'square',
        attack: 0.001,
        decay: 0.25,
        sustain: 0,
        release: 0.08,
        filterCutoff: 4500,
        filterQ: 12.0,
        filterAttack: 0.001,
        filterDecay: 0.15,
        filterSustain: 0,
        filterRelease: 0.08,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.5
      },
      bassPluck: {
        wave: 'sawtooth',
        attack: 0.001,
        decay: 0.5,
        sustain: 0,
        release: 0.2,
        filterCutoff: 800,
        filterQ: 4.0,
        filterAttack: 0.001,
        filterDecay: 0.4,
        filterSustain: 0,
        filterRelease: 0.2,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.5
      },

      // ‚îÄ‚îÄ Pads ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      warmPad: {
        wave: 'sawtooth',
        unisonVoices: 5,
        unisonDetune: 15,
        attack: 0.8,
        decay: 0.5,
        sustain: 0.7,
        release: 1.5,
        filterCutoff: 1500,
        filterQ: 1.2,
        filterAttack: 1.0,
        filterDecay: 0.6,
        filterSustain: 0.5,
        filterRelease: 1.5,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.3,
        lfoDepth: 0.2
      },
      brightPad: {
        wave: 'triangle',
        unisonVoices: 3,
        unisonDetune: 12,
        attack: 0.5,
        decay: 0.3,
        sustain: 0.8,
        release: 1.2,
        filterCutoff: 3500,
        filterQ: 1.0,
        filterAttack: 0.6,
        filterDecay: 0.4,
        filterSustain: 0.7,
        filterRelease: 1.2,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.15
      },
      choirPad: {
        wave: 'sine',
        unisonVoices: 5,
        unisonDetune: 20,
        attack: 1.2,
        decay: 0.4,
        sustain: 0.9,
        release: 2.0,
        filterCutoff: 2500,
        filterQ: 0.8,
        filterAttack: 1.5,
        filterDecay: 0.5,
        filterSustain: 0.8,
        filterRelease: 2.0,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.2,
        lfoDepth: 0.1
      },
      stringPad: {
        wave: 'sawtooth',
        unisonVoices: 5,
        unisonDetune: 18,
        attack: 0.6,
        decay: 0.4,
        sustain: 0.75,
        release: 1.8,
        filterCutoff: 2200,
        filterQ: 2.0,
        filterAttack: 0.8,
        filterDecay: 0.5,
        filterSustain: 0.6,
        filterRelease: 1.8,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.4,
        lfoDepth: 0.18
      },
      darkPad: {
        wave: 'triangle',
        unisonVoices: 3,
        unisonDetune: 10,
        attack: 1.0,
        decay: 0.6,
        sustain: 0.85,
        release: 2.5,
        filterCutoff: 800,
        filterQ: 1.5,
        filterAttack: 1.2,
        filterDecay: 0.7,
        filterSustain: 0.7,
        filterRelease: 2.5,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.25,
        lfoDepth: 0.12
      },

      // ‚îÄ‚îÄ Leads ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      classicLead: {
        wave: 'sawtooth',
        unisonVoices: 2,
        unisonDetune: 8,
        attack: 0.01,
        decay: 0.2,
        sustain: 0.6,
        release: 0.3,
        filterCutoff: 2800,
        filterQ: 4.5,
        filterAttack: 0.02,
        filterDecay: 0.35,
        filterSustain: 0.5,
        filterRelease: 0.3,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.3
      },
      brightLead: {
        wave: 'square',
        attack: 0.005,
        decay: 0.15,
        sustain: 0.7,
        release: 0.2,
        filterCutoff: 5500,
        filterQ: 3.0,
        filterAttack: 0.01,
        filterDecay: 0.2,
        filterSustain: 0.6,
        filterRelease: 0.2,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 1.0,
        lfoDepth: 0.25
      },
      smoothLead: {
        wave: 'triangle',
        unisonVoices: 3,
        unisonDetune: 10,
        attack: 0.05,
        decay: 0.25,
        sustain: 0.65,
        release: 0.4,
        filterCutoff: 3200,
        filterQ: 2.5,
        filterAttack: 0.08,
        filterDecay: 0.3,
        filterSustain: 0.55,
        filterRelease: 0.4,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.2
      },
      vintageLead: {
        wave: 'sawtooth',
        unisonVoices: 2,
        unisonDetune: 12,
        attack: 0.02,
        decay: 0.4,
        sustain: 0.5,
        release: 0.35,
        filterCutoff: 2200,
        filterQ: 8.0,
        filterAttack: 0.03,
        filterDecay: 0.5,
        filterSustain: 0.4,
        filterRelease: 0.35,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.5,
        lfoDepth: 0.35
      },
      synthLead: {
        wave: 'square',
        unisonVoices: 3,
        unisonDetune: 15,
        attack: 0.01,
        decay: 0.18,
        sustain: 0.68,
        release: 0.25,
        filterCutoff: 4200,
        filterQ: 5.5,
        filterAttack: 0.015,
        filterDecay: 0.25,
        filterSustain: 0.58,
        filterRelease: 0.25,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 0.7,
        lfoDepth: 0.28
      },

      // ‚îÄ‚îÄ Experimental ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      wobble: {
        wave: 'sawtooth',
        unisonVoices: 3,
        unisonDetune: 20,
        attack: 0.01,
        decay: 0.3,
        sustain: 0.7,
        release: 0.4,
        filterCutoff: 1800,
        filterQ: 8.0,
        filterAttack: 0,
        filterDecay: 0,
        filterSustain: 1,
        filterRelease: 0.01,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: false,
        lfoEnabled: true,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 1.5,
        lfoDepth: 0.7
      },
      tremolo: {
        wave: 'triangle',
        attack: 0.02,
        decay: 0.2,
        sustain: 0.8,
        release: 0.3,
        filterCutoff: 3500,
        filterQ: 2.0,
        filterAttack: 0,
        filterDecay: 0,
        filterSustain: 1,
        filterRelease: 0.01,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: false,
        lfoEnabled: true,
        lfoTarget: 'pitch',
        lfoWave: 'sine',
        lfoRate: 4.0,
        lfoDepth: 0.08
      },
      resonantSweep: {
        wave: 'sawtooth',
        unisonVoices: 2,
        unisonDetune: 8,
        attack: 0.005,
        decay: 0.25,
        sustain: 0.6,
        release: 0.5,
        filterCutoff: 800,
        filterQ: 15.0,
        filterAttack: 0.01,
        filterDecay: 1.2,
        filterSustain: 0.3,
        filterRelease: 0.5,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: false,
        lfoTarget: 'cutoff',
        lfoWave: 'sine',
        lfoRate: 2.0,
        lfoDepth: 0.5
      },
      phaser: {
        wave: 'square',
        unisonVoices: 3,
        unisonDetune: 15,
        attack: 0.03,
        decay: 0.3,
        sustain: 0.65,
        release: 0.4,
        filterCutoff: 2500,
        filterQ: 6.0,
        filterAttack: 0,
        filterDecay: 0,
        filterSustain: 1,
        filterRelease: 0.01,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: false,
        lfoEnabled: true,
        lfoTarget: 'q',
        lfoWave: 'sine',
        lfoRate: 0.8,
        lfoDepth: 0.6
      },
      glitch: {
        wave: 'triangle',
        attack: 0.001,
        decay: 0.12,
        sustain: 0.5,
        release: 0.15,
        filterCutoff: 4500,
        filterQ: 7.0,
        filterAttack: 0.001,
        filterDecay: 0.08,
        filterSustain: 0.4,
        filterRelease: 0.15,
        ampEnvEnabled: true,
        filterEnabled: true,
        filterEnvEnabled: true,
        lfoEnabled: true,
        lfoTarget: 'pitch',
        lfoWave: 'square',
        lfoRate: 12.0,
        lfoDepth: 0.15
      }
    };

    const _synth = Object.assign({}, _synthDefaults);
    let _currentPreset = ''; // Track currently loaded preset

    function _synthUpdateGroupStates() {
      document.getElementById('ampEnvGroup').classList.toggle('disabled-group', !_synth.ampEnvEnabled);
      document.getElementById('filterGroup').classList.toggle('disabled-group', !_synth.filterEnabled);
      document.getElementById('filterEnvGroup').classList.toggle('disabled-group', !_synth.filterEnvEnabled || !_synth.filterEnabled);
      document.getElementById('lfoGroup').classList.toggle('disabled-group', !_synth.lfoEnabled);
    }

    function _synthLoadPreset(presetName) {
      if (!presetName || !_synthPresets[presetName]) return;

      const preset = _synthPresets[presetName];
      Object.assign(_synth, _synthDefaults, preset);
      _currentPreset = presetName;

      // Update all UI controls
      document.getElementById('synthWave').value = _synth.wave;
      document.getElementById('synthUnisonVoices').value = _synth.unisonVoices;
      document.getElementById('synthUnisonDetune').value = _synth.unisonDetune;
      document.getElementById('synthAttack').value = _synth.attack;
      document.getElementById('synthDecay').value = _synth.decay;
      document.getElementById('synthSustain').value = _synth.sustain;
      document.getElementById('synthRelease').value = _synth.release;
      document.getElementById('synthCutoff').value = _synth.filterCutoff;
      document.getElementById('synthQ').value = _synth.filterQ;
      document.getElementById('synthFilterAttack').value = _synth.filterAttack;
      document.getElementById('synthFilterDecay').value = _synth.filterDecay;
      document.getElementById('synthFilterSustain').value = _synth.filterSustain;
      document.getElementById('synthFilterRelease').value = _synth.filterRelease;
      document.getElementById('synthAmpEnvEnabled').checked = _synth.ampEnvEnabled;
      document.getElementById('synthFilterEnabled').checked = _synth.filterEnabled;
      document.getElementById('synthFilterEnvEnabled').checked = _synth.filterEnvEnabled;
      document.getElementById('synthLfoEnabled').checked = _synth.lfoEnabled;
      document.getElementById('synthLfoTarget').value = _synth.lfoTarget;
      document.getElementById('synthLfoWave').value = _synth.lfoWave;
      document.getElementById('synthLfoRate').value = _synth.lfoRate;
      document.getElementById('synthLfoDepth').value = _synth.lfoDepth;

      _synthUpdateLabels();
      _synthUpdateGroupStates();
    }

    function _synthResetControls() {
      Object.assign(_synth, _synthDefaults);
      _currentPreset = ''; // Clear current preset
      document.getElementById('synthPreset').value = ''; // Reset dropdown
      document.getElementById('synthWave').value = _synth.wave;
      document.getElementById('synthUnisonVoices').value = _synth.unisonVoices;
      document.getElementById('synthUnisonDetune').value = _synth.unisonDetune;
      document.getElementById('synthAttack').value = _synth.attack;
      document.getElementById('synthDecay').value = _synth.decay;
      document.getElementById('synthSustain').value = _synth.sustain;
      document.getElementById('synthRelease').value = _synth.release;
      document.getElementById('synthCutoff').value = _synth.filterCutoff;
      document.getElementById('synthQ').value = _synth.filterQ;
      document.getElementById('synthFilterAttack').value = _synth.filterAttack;
      document.getElementById('synthFilterDecay').value = _synth.filterDecay;
      document.getElementById('synthFilterSustain').value = _synth.filterSustain;
      document.getElementById('synthFilterRelease').value = _synth.filterRelease;
      document.getElementById('synthAmpEnvEnabled').checked = _synth.ampEnvEnabled;
      document.getElementById('synthFilterEnabled').checked = _synth.filterEnabled;
      document.getElementById('synthFilterEnvEnabled').checked = _synth.filterEnvEnabled;
      document.getElementById('synthLfoEnabled').checked = _synth.lfoEnabled;
      document.getElementById('synthLfoTarget').value = _synth.lfoTarget;
      document.getElementById('synthLfoWave').value = _synth.lfoWave;
      document.getElementById('synthLfoRate').value = _synth.lfoRate;
      document.getElementById('synthLfoDepth').value = _synth.lfoDepth;
      _synthUpdateLabels();
      _synthUpdateGroupStates();
    }

    function _synthUpdateLabels() {
      document.getElementById('synthAVal').textContent = Number(_synth.attack).toFixed(2) + 's';
      document.getElementById('synthDVal').textContent = Number(_synth.decay).toFixed(2) + 's';
      document.getElementById('synthSVal').textContent = Math.round(_synth.sustain * 100) + '%';
      document.getElementById('synthRVal').textContent = Number(_synth.release).toFixed(2) + 's';
      document.getElementById('synthCutoffVal').textContent = Math.round(_synth.filterCutoff);
      document.getElementById('synthQVal').textContent = Number(_synth.filterQ).toFixed(1);
      document.getElementById('synthFAVal').textContent = Number(_synth.filterAttack).toFixed(2) + 's';
      document.getElementById('synthFDVal').textContent = Number(_synth.filterDecay).toFixed(2) + 's';
      document.getElementById('synthFSVal').textContent = Math.round(_synth.filterSustain * 100) + '%';
      document.getElementById('synthFRVal').textContent = Number(_synth.filterRelease).toFixed(2) + 's';
      document.getElementById('synthLfoRateVal').textContent = Number(_synth.lfoRate).toFixed(1) + ' Hz';
      document.getElementById('synthLfoDepthVal').textContent = Math.round(_synth.lfoDepth * 100) + '%';
      document.getElementById('synthUnisonVoicesVal').textContent = _synth.unisonVoices;
      document.getElementById('synthUnisonDetuneVal').textContent = _synth.unisonDetune + ' ct';
    }

    (function _initSynthControls() {
      document.getElementById('synthPreset').addEventListener('change', e => {
        const presetName = e.target.value;
        if (presetName) {
          _synthLoadPreset(presetName);
          // Dropdown will stay on the selected preset
        }
      });

      // Helper function to clear preset on manual change
      function _clearPresetOnChange() {
        if (_currentPreset) {
          _currentPreset = '';
          document.getElementById('synthPreset').value = '';
        }
      }

      document.getElementById('synthWave').addEventListener('input', e => { _synth.wave = e.target.value; _clearPresetOnChange(); });
      document.getElementById('synthUnisonVoices').addEventListener('input', e => { _synth.unisonVoices = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthUnisonDetune').addEventListener('input', e => { _synth.unisonDetune = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthAttack').addEventListener('input', e => { _synth.attack = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthDecay').addEventListener('input', e => { _synth.decay = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthSustain').addEventListener('input', e => { _synth.sustain = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthRelease').addEventListener('input', e => { _synth.release = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthCutoff').addEventListener('input', e => { _synth.filterCutoff = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthQ').addEventListener('input', e => { _synth.filterQ = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthFilterAttack').addEventListener('input', e => { _synth.filterAttack = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthFilterDecay').addEventListener('input', e => { _synth.filterDecay = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthFilterSustain').addEventListener('input', e => { _synth.filterSustain = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthFilterRelease').addEventListener('input', e => { _synth.filterRelease = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthAmpEnvEnabled').addEventListener('change', e => { _synth.ampEnvEnabled = e.target.checked; _synthUpdateGroupStates(); _clearPresetOnChange(); });
      document.getElementById('synthFilterEnabled').addEventListener('change', e => { _synth.filterEnabled = e.target.checked; _synthUpdateGroupStates(); _clearPresetOnChange(); });
      document.getElementById('synthFilterEnvEnabled').addEventListener('change', e => { _synth.filterEnvEnabled = e.target.checked; _synthUpdateGroupStates(); _clearPresetOnChange(); });
      document.getElementById('synthLfoEnabled').addEventListener('change', e => { _synth.lfoEnabled = e.target.checked; _synthUpdateGroupStates(); _clearPresetOnChange(); });
      document.getElementById('synthLfoTarget').addEventListener('change', e => { _synth.lfoTarget = e.target.value; _clearPresetOnChange(); });
      document.getElementById('synthLfoWave').addEventListener('change', e => { _synth.lfoWave = e.target.value; _clearPresetOnChange(); });
      document.getElementById('synthLfoRate').addEventListener('input', e => { _synth.lfoRate = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthLfoDepth').addEventListener('input', e => { _synth.lfoDepth = +e.target.value; _synthUpdateLabels(); _clearPresetOnChange(); });
      document.getElementById('synthReset').addEventListener('click', _synthResetControls);

      /* Sync _synth state from DOM in case the browser restored form values after reload */
      _synth.wave = document.getElementById('synthWave').value;
      _synth.unisonVoices = +document.getElementById('synthUnisonVoices').value;
      _synth.unisonDetune = +document.getElementById('synthUnisonDetune').value;
      _synth.attack = +document.getElementById('synthAttack').value;
      _synth.decay = +document.getElementById('synthDecay').value;
      _synth.sustain = +document.getElementById('synthSustain').value;
      _synth.release = +document.getElementById('synthRelease').value;
      _synth.filterCutoff = +document.getElementById('synthCutoff').value;
      _synth.filterQ = +document.getElementById('synthQ').value;
      _synth.filterAttack = +document.getElementById('synthFilterAttack').value;
      _synth.filterDecay = +document.getElementById('synthFilterDecay').value;
      _synth.filterSustain = +document.getElementById('synthFilterSustain').value;
      _synth.filterRelease = +document.getElementById('synthFilterRelease').value;
      _synth.ampEnvEnabled = document.getElementById('synthAmpEnvEnabled').checked;
      _synth.filterEnabled = document.getElementById('synthFilterEnabled').checked;
      _synth.filterEnvEnabled = document.getElementById('synthFilterEnvEnabled').checked;
      _synth.lfoEnabled = document.getElementById('synthLfoEnabled').checked;
      _synth.lfoTarget = document.getElementById('synthLfoTarget').value;
      _synth.lfoWave = document.getElementById('synthLfoWave').value;
      _synth.lfoRate = +document.getElementById('synthLfoRate').value;
      _synth.lfoDepth = +document.getElementById('synthLfoDepth').value;
      _synthUpdateLabels();
      _synthUpdateGroupStates();

      /* Force a full reset on page load ‚Äî this matches the behavior of
         clicking the Reset button, which empirically fixes the first-note
         audio glitch across browsers. */
      _synthResetControls();
    })();

    let _audioCtx = null;
    let _analyser = null;
    let _masterGain = null;
    let _pendingNotes = null; // {notes,strumDelay} while awaiting resume()

    function _initAudioCtx() {
      if (_audioCtx) return;
      _audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      // Create a master chain: voices ‚Üí _masterGain ‚Üí _analyser ‚Üí destination
      _masterGain = _audioCtx.createGain();
      _masterGain.gain.value = 1;
      _analyser = _audioCtx.createAnalyser();
      _analyser.fftSize = 2048;
      _masterGain.connect(_analyser).connect(_audioCtx.destination);
      _startScope();
    }

    /* ‚îÄ‚îÄ Welcome-modal click initialises audio ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       The modal forces a real user gesture before anything else,
       so we can safely create + resume the AudioContext here. */
    document.getElementById('welcomeOverlay').addEventListener('click', () => {
      _initAudioCtx();
      if (_audioCtx.state === 'suspended') _audioCtx.resume();
      document.getElementById('welcomeOverlay').classList.add('hidden');
    });

    function _ctx() {
      _initAudioCtx();
      if (_audioCtx.state === 'suspended') _audioCtx.resume();
      return _audioCtx;
    }
    function _ctxSync() { return _audioCtx; }
    function _dest() { return _masterGain || _audioCtx.destination; }

    /* ‚îÄ‚îÄ Scope drawing ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    let _scopeRafId = null;
    let _scopeEnvBuffer = [];       // ring buffer of peak amplitudes
    let _scopeEnvWriteIdx = 0;
    const _SCOPE_ENV_MAX_SAMPLES = 512;  // how many envelope samples we store

    function _startScope() {
      const canvas = document.getElementById('scopeCanvas');
      const modeSelect = document.getElementById('scopeMode');
      const windowSelect = document.getElementById('scopeWindow');
      const dataArray = new Float32Array(_analyser.fftSize);

      // Initialise envelope buffer
      _scopeEnvBuffer = new Float32Array(_SCOPE_ENV_MAX_SAMPLES);
      _scopeEnvWriteIdx = 0;

      let lastEnvTime = 0;

      function draw() {
        _scopeRafId = requestAnimationFrame(draw);
        const ctx2d = canvas.getContext('2d');
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        const w = Math.round(rect.width * dpr);
        const h = Math.round(rect.height * dpr);
        if (canvas.width !== w || canvas.height !== h) {
          canvas.width = w;
          canvas.height = h;
        }
        ctx2d.clearRect(0, 0, w, h);

        const mode = modeSelect.value;
        _analyser.getFloatTimeDomainData(dataArray);

        if (mode === 'waveform') {
          // Classic oscilloscope
          ctx2d.strokeStyle = '#38bdf8';
          ctx2d.lineWidth = dpr;
          ctx2d.beginPath();
          const sliceW = w / dataArray.length;
          for (let i = 0; i < dataArray.length; i++) {
            const y = (1 - dataArray[i]) * h / 2;
            if (i === 0) ctx2d.moveTo(0, y); else ctx2d.lineTo(i * sliceW, y);
          }
          ctx2d.stroke();
        } else {
          // Scrolling envelope view
          const windowSec = +(windowSelect.value) || 2;
          // We sample the peak about 60 times/sec; figure out how many samples to show
          const samplesPerSec = 60;
          const samplesToShow = Math.min(samplesPerSec * windowSec, _SCOPE_ENV_MAX_SAMPLES);

          // Compute current peak from raw waveform
          const now = performance.now();
          const envInterval = 1000 / samplesPerSec;
          if (now - lastEnvTime >= envInterval) {
            let peak = 0;
            for (let i = 0; i < dataArray.length; i++) {
              const v = Math.abs(dataArray[i]);
              if (v > peak) peak = v;
            }
            _scopeEnvBuffer[_scopeEnvWriteIdx % _SCOPE_ENV_MAX_SAMPLES] = peak;
            _scopeEnvWriteIdx++;
            lastEnvTime = now;
          }

          // Draw grid lines
          ctx2d.strokeStyle = '#1e293b';
          ctx2d.lineWidth = dpr;
          for (let db = 0; db <= 1; db += 0.25) {
            const y = (1 - db) * h;
            ctx2d.beginPath();
            ctx2d.moveTo(0, y);
            ctx2d.lineTo(w, y);
            ctx2d.stroke();
          }

          // Draw envelope
          ctx2d.strokeStyle = '#38bdf8';
          ctx2d.fillStyle = 'rgba(56, 189, 248, 0.12)';
          ctx2d.lineWidth = 1.5 * dpr;
          ctx2d.beginPath();
          const total = Math.min(_scopeEnvWriteIdx, samplesToShow);
          const startIdx = _scopeEnvWriteIdx - total;
          for (let i = 0; i < total; i++) {
            const idx = (startIdx + i) % _SCOPE_ENV_MAX_SAMPLES;
            const amp = Math.min(_scopeEnvBuffer[idx] * 4, 1); // scale up for visibility
            const x = (i / samplesToShow) * w;
            const y = (1 - amp) * h;
            if (i === 0) ctx2d.moveTo(x, y); else ctx2d.lineTo(x, y);
          }
          ctx2d.stroke();
          // Fill under the curve
          if (total > 0) {
            const lastX = ((total - 1) / samplesToShow) * w;
            ctx2d.lineTo(lastX, h);
            ctx2d.lineTo(0, h);
            ctx2d.closePath();
            ctx2d.fill();
          }

          // Time labels
          ctx2d.fillStyle = '#64748b';
          ctx2d.font = `${10 * dpr}px system-ui`;
          ctx2d.textAlign = 'center';
          for (let t = 0; t <= windowSec; t += 0.5) {
            const x = (t / windowSec) * w;
            ctx2d.fillText(`${t.toFixed(1)}s`, x, h - 3 * dpr);
          }
        }
      }
      draw();
    }

    function _midiToFreq(m) { return 440 * Math.pow(2, (m - 69) / 12); }

    const _MIN_GAIN = 0.0001;       // Near-zero gain (Web Audio exponentialRamp can't target 0)
    const _MIN_FILTER_FREQ = 20;    // Minimum filter frequency in Hz

    let _activeVoices = [];

    function _createLFO(ctx, target, baseValue, t0) {
      const lfo = ctx.createOscillator();
      const lfoGain = ctx.createGain();

      lfo.type = _synth.lfoWave;
      lfo.frequency.value = _synth.lfoRate;

      // Calculate modulation depth based on target parameter
      let depth = 0;
      if (_synth.lfoTarget === 'cutoff') {
        // For cutoff: modulate around the base cutoff value
        depth = baseValue * _synth.lfoDepth;
      } else if (_synth.lfoTarget === 'q') {
        // For Q: modulate around the base Q value
        depth = baseValue * _synth.lfoDepth;
      } else if (_synth.lfoTarget === 'pitch') {
        // For pitch: depth in semitones (max ¬±12 semitones at 100% depth)
        depth = 12 * _synth.lfoDepth;
      }

      lfoGain.gain.value = depth;
      lfo.connect(lfoGain);
      lfo.start(t0);

      return { lfo, lfoGain };
    }

    function _applyNoteOn(g, vol, t0) {
      const a = _synth.attack;
      const d = _synth.decay;
      const s = _synth.sustain;
      const sustainLevel = Math.max(vol * s, _MIN_GAIN);
      const attackEnd = t0 + a;

      g.gain.setValueAtTime(_MIN_GAIN, t0);
      if (a > 0) {
        g.gain.linearRampToValueAtTime(vol, attackEnd);
      } else {
        g.gain.setValueAtTime(vol, t0);
      }
      if (d > 0) {
        g.gain.linearRampToValueAtTime(sustainLevel, attackEnd + d);
      } else {
        g.gain.setValueAtTime(sustainLevel, attackEnd);
      }
    }

    function _applyFilterNoteOn(filt, t0) {
      const cutoff = _synth.filterCutoff;
      const fA = _synth.filterAttack;
      const fD = _synth.filterDecay;
      const fS = _synth.filterSustain;
      const sustainFreq = Math.max(_MIN_FILTER_FREQ + (cutoff - _MIN_FILTER_FREQ) * fS, _MIN_FILTER_FREQ);
      const attackEnd = t0 + fA;

      filt.frequency.setValueAtTime(_MIN_FILTER_FREQ, t0);
      if (fA > 0) {
        filt.frequency.linearRampToValueAtTime(cutoff, attackEnd);
      } else {
        filt.frequency.setValueAtTime(cutoff, t0);
      }
      if (fD > 0) {
        filt.frequency.linearRampToValueAtTime(sustainFreq, attackEnd + fD);
      } else {
        filt.frequency.setValueAtTime(sustainFreq, attackEnd);
      }
    }

    function _releaseVoices() {
      _pendingNotes = null;  // cancel any note-on pending behind a resume()
      if (!_activeVoices.length) return;
      const ctx = _ctxSync();
      if (!ctx) return;
      const now = ctx.currentTime;
      const r = Math.max(_synth.release, 0.01);
      const fr = Math.max(_synth.filterRelease, 0.01);
      let maxRelease = 0;

      _activeVoices.forEach(voice => {
        if (_synth.ampEnvEnabled) {
          voice.gain.gain.cancelScheduledValues(now);
          voice.gain.gain.setValueAtTime(Math.max(voice.gain.gain.value, _MIN_GAIN), now);
          voice.gain.gain.exponentialRampToValueAtTime(_MIN_GAIN, now + r);
          maxRelease = Math.max(maxRelease, r);
        }

        if (voice.filter && _synth.filterEnabled && _synth.filterEnvEnabled) {
          voice.filter.frequency.cancelScheduledValues(now);
          voice.filter.frequency.setValueAtTime(Math.max(voice.filter.frequency.value, _MIN_FILTER_FREQ), now);
          voice.filter.frequency.linearRampToValueAtTime(_MIN_FILTER_FREQ, now + fr);
          maxRelease = Math.max(maxRelease, fr);
        }

        if (!_synth.ampEnvEnabled) {
          /* No envelope ‚Äî just cut the gain quickly */
          voice.gain.gain.setValueAtTime(voice.gain.gain.value, now);
          voice.gain.gain.linearRampToValueAtTime(0, now + 0.02);
          maxRelease = Math.max(maxRelease, 0.02);
        }

        voice.oscs.forEach(o => o.stop(now + maxRelease + 0.05));
        if (voice.lfo) {
          voice.lfo.stop(now + maxRelease + 0.05);
        }
      });

      _activeVoices = [];
    }

    /* Create oscillator voices for the given MIDI notes and push them into _activeVoices.
       IMPORTANT: only call this when _audioCtx.state === 'running' so that
       ctx.currentTime is reliably advancing. */
    function _createVoices(ctx, midiNotes, strumDelay) {
      const now = ctx.currentTime;
      const vol = 0.22 / Math.sqrt(midiNotes.length * _synth.unisonVoices);
      const notes = strumDelay > 0
        ? midiNotes.slice().sort((a, b) => a - b)
        : midiNotes;
      notes.forEach((m, i) => {
        const t0 = now + i * strumDelay;
        const freq = _midiToFreq(m);
        const g   = ctx.createGain();

        // Create unison oscillators
        const numUni = _synth.unisonVoices;
        const oscs = [];
        for (let u = 0; u < numUni; u++) {
          const osc = ctx.createOscillator();
          osc.type = _synth.wave;
          osc.frequency.value = freq;
          if (numUni > 1) {
            osc.detune.value = (u / (numUni - 1) - 0.5) * _synth.unisonDetune;
          }
          osc.connect(g);
          oscs.push(osc);
        }

        if (_synth.ampEnvEnabled) {
          g.gain.value = _MIN_GAIN;
          _applyNoteOn(g, vol, t0);
        } else {
          g.gain.value = vol;
        }

        let tail = g;
        let lfoNodes = null;
        let filterNode = null;

        if (_synth.filterEnabled) {
          const filt = ctx.createBiquadFilter();
          filt.type = 'lowpass';
          filt.frequency.value = _synth.filterCutoff;
          filt.Q.value = _synth.filterQ;
          if (_synth.filterEnvEnabled) {
            _applyFilterNoteOn(filt, t0);
          }

          // Apply LFO if enabled
          if (_synth.lfoEnabled) {
            if (_synth.lfoTarget === 'cutoff') {
              lfoNodes = _createLFO(ctx, filt.frequency, _synth.filterCutoff, t0);
              lfoNodes.lfoGain.connect(filt.frequency);
            } else if (_synth.lfoTarget === 'q') {
              lfoNodes = _createLFO(ctx, filt.Q, _synth.filterQ, t0);
              lfoNodes.lfoGain.connect(filt.Q);
            }
          }

          g.connect(filt);
          tail = filt;
          filterNode = filt;
        }

        // Apply LFO to pitch if enabled
        if (_synth.lfoEnabled && _synth.lfoTarget === 'pitch') {
          lfoNodes = _createLFO(ctx, null, 0, t0);
          oscs.forEach(o => lfoNodes.lfoGain.connect(o.detune));
        }

        tail.connect(_dest());
        oscs.forEach(o => o.start(t0));
        _activeVoices.push({ oscs, gain: g, filter: filterNode, lfo: lfoNodes?.lfo || null });
      });
    }

    function _startNotes(midiNotes) {
      _releaseVoices();
      _initAudioCtx();
      if (_audioCtx.state === 'running') {
        _createVoices(_audioCtx, midiNotes, 0);
      } else {
        /* Context is suspended (autoplay policy). Call resume() inside this
           user-gesture handler and wait for it to complete before scheduling
           any automation ‚Äî this guarantees currentTime is advancing. */
        _pendingNotes = { notes: midiNotes, strumDelay: 0 };
        _audioCtx.resume().then(() => {
          if (_pendingNotes) {
            _createVoices(_audioCtx, _pendingNotes.notes, _pendingNotes.strumDelay);
            _pendingNotes = null;
          }
        });
      }
    }

    function _startNotesStrummed(midiNotes) {
      _releaseVoices();
      _initAudioCtx();
      const strumDelay = 0.07;
      if (_audioCtx.state === 'running') {
        _createVoices(_audioCtx, midiNotes, strumDelay);
      } else {
        _pendingNotes = { notes: midiNotes, strumDelay };
        _audioCtx.resume().then(() => {
          if (_pendingNotes) {
            _createVoices(_audioCtx, _pendingNotes.notes, _pendingNotes.strumDelay);
            _pendingNotes = null;
          }
        });
      }
    }

    /* ‚îÄ‚îÄ Click handling (event delegation) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    let _activePopupTimeout = null;

    function _showChordPopup(notes, mouseEvent) {
      const popup = document.getElementById('chord-popup');
      const canvas = document.getElementById('chord-popup-canvas');
      const notesDiv = document.getElementById('chord-popup-notes');

      // Always show 5 octaves, adjust width to fit screen
      const numOctaves = 5;
      const screenWidth = window.innerWidth;
      const maxAvailableWidth = screenWidth - 40; // Leave 20px padding on each side

      let canvasWidth, canvasHeight;

      if (screenWidth < 480) {
        // Mobile portrait: squeeze 5 octaves into available width
        canvasWidth = Math.min(maxAvailableWidth, screenWidth - 30); // Minimal padding
        canvasHeight = 60;
      } else if (screenWidth < 768) {
        // Tablet or mobile landscape: 5 octaves with medium keys
        canvasWidth = Math.min(maxAvailableWidth, 700);
        canvasHeight = 70;
      } else {
        // Desktop: 5 octaves, full size (30px per white key)
        canvasWidth = 1050; // 5 octaves * 7 keys * 30px
        canvasHeight = 80;
      }

      // Set canvas size
      canvas.width = canvasWidth;
      canvas.height = canvasHeight;

      // Draw the keyboard with highlighted notes
      _drawPopupKeyboard(canvas, notes, numOctaves);

      // Display note names (sorted from lowest to highest)
      const noteNames = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
      const sortedNotes = [...notes].sort((a, b) => a - b);
      const noteNamesArray = sortedNotes.map(midi => {
        const octave = Math.floor(midi / 12) - 1;
        const noteName = noteNames[midi % 12];
        return `${noteName}${octave}`;
      });
      notesDiv.textContent = noteNamesArray.join(' ‚Ä¢ ');

      // Position the popup
      const x = mouseEvent.clientX;
      const y = mouseEvent.clientY;
      const popupWidth = canvasWidth + 30; // canvas + padding
      const popupHeight = canvasHeight + 50; // canvas + notes + padding

      // Center horizontally on mobile, otherwise follow cursor
      let left, top;
      if (screenWidth < 768) {
        // Center horizontally on mobile/tablet
        left = Math.max(10, (screenWidth - popupWidth) / 2);
        // Position above touch point if possible, otherwise below
        top = y - popupHeight - 20;
        if (top < 10) {
          top = Math.min(y + 60, window.innerHeight - popupHeight - 10);
        }
      } else {
        // Desktop: position above cursor, centered horizontally
        left = x - popupWidth / 2;
        top = y - popupHeight - 20;

        // Keep within viewport
        if (left < 10) left = 10;
        if (left + popupWidth > screenWidth - 10) {
          left = screenWidth - popupWidth - 10;
        }
        if (top < 10) {
          top = y + 20;
        }
      }

      popup.style.left = `${left}px`;
      popup.style.top = `${top}px`;
      popup.classList.add('visible');
    }

    function _hideChordPopup() {
      const popup = document.getElementById('chord-popup');
      popup.classList.remove('visible');
    }

    function _drawPopupKeyboard(canvas, midiNotes, numOctaves) {
      const ctx = canvas.getContext('2d');
      const width = canvas.width;
      const height = canvas.height;

      // Clear canvas
      ctx.clearRect(0, 0, width, height);

      // Calculate key dimensions based on canvas width
      const numWhiteKeys = numOctaves * 7;
      const whiteKeyWidth = width / numWhiteKeys;
      const blackKeyWidth = whiteKeyWidth * 0.6;
      const whiteKeyHeight = height;
      const blackKeyHeight = height * 0.6;

      // Black key offsets (centered between white keys)
      const blackOffsets = [
        whiteKeyWidth,           // C# between C-D
        whiteKeyWidth * 2,       // D# between D-E
        whiteKeyWidth * 4,       // F# between F-G
        whiteKeyWidth * 5,       // G# between G-A
        whiteKeyWidth * 6        // A# between A-B
      ];

      // Convert MIDI notes to set for quick lookup
      const notesSet = new Set(midiNotes);

      // Find the range of notes to display (center around the chord)
      const minNote = Math.min(...midiNotes);
      const maxNote = Math.max(...midiNotes);
      const centerNote = Math.floor((minNote + maxNote) / 2);
      const centerOctave = Math.floor(centerNote / 12);

      // Display octaves centered around the chord, starting from at least octave 2 (MIDI 36 = C2)
      const startOctave = Math.max(3, centerOctave - Math.floor(numOctaves / 2));
      const startMidi = startOctave * 12;

      // Draw white keys
      const whiteNoteOffsets = [0, 2, 4, 5, 7, 9, 11]; // C, D, E, F, G, A, B
      let whiteKeyIndex = 0;

      for (let octave = 0; octave < numOctaves; octave++) {
        for (let i = 0; i < 7; i++) {
          const midi = startMidi + octave * 12 + whiteNoteOffsets[i];
          const x = whiteKeyIndex * whiteKeyWidth;

          ctx.fillStyle = notesSet.has(midi) ? '#38bdf8' : '#f8fafc';
          ctx.fillRect(x, 0, whiteKeyWidth, whiteKeyHeight);
          ctx.strokeStyle = '#94a3b8';
          ctx.lineWidth = 1;
          ctx.strokeRect(x, 0, whiteKeyWidth, whiteKeyHeight);

          whiteKeyIndex++;
        }
      }

      // Draw black keys (positioned exactly between white keys)
      const blackNotes = [1, 3, 6, 8, 10]; // C#, D#, F#, G#, A#

      for (let octave = 0; octave < numOctaves; octave++) {
        const startX = octave * 7 * whiteKeyWidth;
        for (let i = 0; i < 5; i++) {
          const midi = startMidi + octave * 12 + blackNotes[i];
          const x = startX + blackOffsets[i] - blackKeyWidth / 2;

          ctx.fillStyle = notesSet.has(midi) ? '#0ea5e9' : '#1e293b';
          ctx.fillRect(x, 0, blackKeyWidth, blackKeyHeight);
          ctx.strokeStyle = '#0f172a';
          ctx.lineWidth = 1;
          ctx.strokeRect(x, 0, blackKeyWidth, blackKeyHeight);
        }
      }
    }

    let _activeKey = null;

    function _handleKeyDown(e) {
      const key = e.target.closest('.white-key, .black-key');
      if (!key) return;

      const notes = _getNotesForKey(key);
      if (!notes || !notes.length) return;

      // Prevent default touch behavior to avoid double-firing on mobile
      if (e.type.startsWith('touch')) {
        e.preventDefault();
      }

      // Get coordinates from touch or mouse event
      const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
      const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;

      _showChordPopup(notes, { clientX, clientY });
      if (e.button === 2) {
        _startNotesStrummed(notes);
      } else {
        _startNotes(notes);
      }

      /* visual feedback */
      key.classList.add('active');
      _activeKey = key;
    }

    function _handleKeyUp() {
      _releaseVoices();
      _hideChordPopup();
      if (_activeKey) {
        _activeKey.classList.remove('active');
        _activeKey = null;
      }
    }

    // Listen for both mouse and touch events
    document.addEventListener('mousedown', _handleKeyDown);
    document.addEventListener('mouseup', _handleKeyUp);
    document.addEventListener('touchstart', _handleKeyDown, { passive: false });
    document.addEventListener('touchend', _handleKeyUp);
    document.addEventListener('touchcancel', _handleKeyUp);

    // Prevent context menu on chord keys so right-click can strum
    document.addEventListener('contextmenu', function(e) {
      if (e.target.closest('.white-key, .black-key')) {
        e.preventDefault();
      }
    });

    // Release notes if mouse/touch leaves the window
    document.addEventListener('mouseleave', _handleKeyUp);

    /* ‚îÄ‚îÄ MIDI Input ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    let _midiAccess = null;
    let _selectedMidiInput = null;
    let _selectedKeyboardId = null;
    let _midiChannel = 0; // 0 = all channels
    let _midiNoteVoices = new Map(); // MIDI note number -> array of voices

    async function _initMIDI() {
      if (!navigator.requestMIDIAccess) {
        console.warn('Web MIDI API not supported');
        return;
      }

      try {
        _midiAccess = await navigator.requestMIDIAccess();
        _populateMIDIDevices();
        _midiAccess.onstatechange = _populateMIDIDevices;
      } catch (err) {
        console.error('Failed to get MIDI access:', err);
      }
    }

    function _populateMIDIDevices() {
      const select = document.getElementById('midiDevice');
      select.innerHTML = '';

      if (!_midiAccess) {
        select.innerHTML = '<option value="">MIDI not available</option>';
        return;
      }

      const inputs = Array.from(_midiAccess.inputs.values());
      if (inputs.length === 0) {
        select.innerHTML = '<option value="">No MIDI devices</option>';
        return;
      }

      inputs.forEach(input => {
        const option = document.createElement('option');
        option.value = input.id;
        option.textContent = input.name;
        select.appendChild(option);
      });

      // Auto-select first device if none selected
      if (!_selectedMidiInput && inputs.length > 0) {
        select.value = inputs[0].id;
        _setMIDIInput(inputs[0].id);
      }
    }

    function _setMIDIInput(deviceId) {
      // Remove listener from previous device
      if (_selectedMidiInput) {
        _selectedMidiInput.onmidimessage = null;
      }

      if (!deviceId || !_midiAccess) {
        _selectedMidiInput = null;
        return;
      }

      _selectedMidiInput = _midiAccess.inputs.get(deviceId);
      if (_selectedMidiInput) {
        _selectedMidiInput.onmidimessage = _handleMIDIMessage;
      }
    }

    function _handleMIDIMessage(event) {
      const [status, note, velocity] = event.data;
      const command = status & 0xF0;
      const channel = (status & 0x0F) + 1; // 1-16

      // Filter by channel if not "All Channels"
      if (_midiChannel !== 0 && channel !== _midiChannel) {
        return;
      }

      // Only handle if MIDI is enabled and a keyboard is selected
      if (!document.getElementById('midiEnabled').checked || _selectedKeyboardId === null) {
        return;
      }

      if (command === 0x90 && velocity > 0) {
        // Note On
        _handleMIDINoteOn(note);
      } else if (command === 0x80 || (command === 0x90 && velocity === 0)) {
        // Note Off - only release voices for this specific MIDI note
        _handleMIDINoteOff(note);
      }
    }

    function _handleMIDINoteOn(midiNote) {
      const set = chordSets.find(s => s.id === _selectedKeyboardId);
      if (!set) return;

      // Get transposition for this keyboard
      const transposition = browserState.get(_selectedKeyboardId) ?? 0;

      // Map MIDI note to chord index (0-11) based on pitch class only
      // This ensures C maps to chord 0, C# to chord 1, etc., regardless of octave
      const chordIndex = midiNote % 12;

      // Calculate which octave the key is in relative to C4 (MIDI 60)
      // C4 = octave 0, C5 = octave 1, C3 = octave -1, etc.
      const midiOctaveOffset = Math.floor((midiNote - 60) / 12);

      // Get the chord at this index (already transposed by the transposition slider)
      const transposed = set.chords.map(ch => transposeChord(ch, transposition));
      const chordName = transposed[chordIndex];

      // Get the exact notes for this chord
      // Combine the user's octave setting with the MIDI octave offset
      const userOctave = octaveState.get(_selectedKeyboardId) ?? 0;
      const totalOctaveShift = (userOctave + midiOctaveOffset) * 12;

      // Use exact notes from CSV if in J6 mode
      const source = noteSourceState.get(_selectedKeyboardId) ?? 'j6';
      let notes = null;

      if (source === 'j6') {
        const setNotes = _exactNotes[set.number];
        if (setNotes && setNotes[chordIndex]) {
          notes = setNotes[chordIndex].map(n => n + transposition + totalOctaveShift);
        }
      }

      // Fallback to interval-based parsing
      if (!notes) {
        notes = _parseChordNotes(chordName);
        if (notes) {
          notes = notes.map(n => n + totalOctaveShift);
        }
      }

      if (notes && notes.length > 0) {
        // If this MIDI note is already playing, release it first (retrigger)
        if (_midiNoteVoices.has(midiNote)) {
          _handleMIDINoteOff(midiNote);
        }

        // Start new voices and track them for this MIDI note
        const voices = _startMIDINotes(notes);
        _midiNoteVoices.set(midiNote, voices);
      }
    }

    function _handleMIDINoteOff(midiNote) {
      const voices = _midiNoteVoices.get(midiNote);
      if (!voices || voices.length === 0) return;

      _midiNoteVoices.delete(midiNote);

      const ctx = _ctxSync();
      if (!ctx) return;
      const now = ctx.currentTime;
      const r = Math.max(_synth.release, 0.01);
      const fr = Math.max(_synth.filterRelease, 0.01);
      let maxRelease = 0;

      voices.forEach(voice => {
        if (_synth.ampEnvEnabled) {
          voice.gain.gain.cancelScheduledValues(now);
          voice.gain.gain.setValueAtTime(Math.max(voice.gain.gain.value, _MIN_GAIN), now);
          voice.gain.gain.exponentialRampToValueAtTime(_MIN_GAIN, now + r);
          maxRelease = Math.max(maxRelease, r);
        }

        if (voice.filter && _synth.filterEnabled && _synth.filterEnvEnabled) {
          voice.filter.frequency.cancelScheduledValues(now);
          voice.filter.frequency.setValueAtTime(Math.max(voice.filter.frequency.value, _MIN_FILTER_FREQ), now);
          voice.filter.frequency.linearRampToValueAtTime(_MIN_FILTER_FREQ, now + fr);
          maxRelease = Math.max(maxRelease, fr);
        }

        if (!_synth.ampEnvEnabled) {
          voice.gain.gain.setValueAtTime(voice.gain.gain.value, now);
          voice.gain.gain.linearRampToValueAtTime(0, now + 0.02);
          maxRelease = Math.max(maxRelease, 0.02);
        }

        voice.oscs.forEach(o => o.stop(now + maxRelease + 0.05));
        if (voice.lfo) {
          voice.lfo.stop(now + maxRelease + 0.05);
        }
      });
    }

    function _startMIDINotes(midiNotes) {
      _initAudioCtx();

      // Wait for context to be running before creating voices
      if (_audioCtx.state !== 'running') {
        _audioCtx.resume();
      }

      const now = _audioCtx.currentTime;
      const vol = 0.22 / Math.sqrt(midiNotes.length * _synth.unisonVoices);
      const voices = [];

      midiNotes.forEach(m => {
        const freq = _midiToFreq(m);
        const g = _audioCtx.createGain();

        // Create unison oscillators
        const numUni = _synth.unisonVoices;
        const oscs = [];
        for (let u = 0; u < numUni; u++) {
          const osc = _audioCtx.createOscillator();
          osc.type = _synth.wave;
          osc.frequency.value = freq;
          if (numUni > 1) {
            osc.detune.value = (u / (numUni - 1) - 0.5) * _synth.unisonDetune;
          }
          osc.connect(g);
          oscs.push(osc);
        }

        if (_synth.ampEnvEnabled) {
          g.gain.value = _MIN_GAIN;
          _applyNoteOn(g, vol, now);
        } else {
          g.gain.value = vol;
        }

        let tail = g;
        let lfoNodes = null;
        let filterNode = null;

        if (_synth.filterEnabled) {
          const filt = _audioCtx.createBiquadFilter();
          filt.type = 'lowpass';
          filt.frequency.value = _synth.filterCutoff;
          filt.Q.value = _synth.filterQ;
          if (_synth.filterEnvEnabled) {
            _applyFilterNoteOn(filt, now);
          }

          // Apply LFO if enabled
          if (_synth.lfoEnabled) {
            if (_synth.lfoTarget === 'cutoff') {
              lfoNodes = _createLFO(_audioCtx, filt.frequency, _synth.filterCutoff, now);
              lfoNodes.lfoGain.connect(filt.frequency);
            } else if (_synth.lfoTarget === 'q') {
              lfoNodes = _createLFO(_audioCtx, filt.Q, _synth.filterQ, now);
              lfoNodes.lfoGain.connect(filt.Q);
            }
          }

          g.connect(filt);
          tail = filt;
          filterNode = filt;
        }

        // Apply LFO to pitch if enabled
        if (_synth.lfoEnabled && _synth.lfoTarget === 'pitch') {
          lfoNodes = _createLFO(_audioCtx, null, 0, now);
          oscs.forEach(o => lfoNodes.lfoGain.connect(o.detune));
        }

        tail.connect(_dest());
        oscs.forEach(o => o.start(now));
        voices.push({ oscs, gain: g, filter: filterNode, lfo: lfoNodes?.lfo || null });
      });

      return voices;
    }

    function _selectKeyboard(cardId) {
      // Remove selection from all cards
      document.querySelectorAll('.card').forEach(card => {
        card.classList.remove('midi-selected');
      });

      // Select the clicked card
      _selectedKeyboardId = cardId;
      const card = document.querySelector(`[data-card-id="${cardId}"]`);
      if (card) {
        card.classList.add('midi-selected');
      }
    }

    // Initialize MIDI controls
    document.getElementById('midiEnabled').addEventListener('change', e => {
      const group = document.getElementById('midiGroup');
      group.classList.toggle('disabled-group', !e.target.checked);

      if (e.target.checked) {
        _initMIDI();
      } else {
        _selectedKeyboardId = null;
        document.querySelectorAll('.card').forEach(card => {
          card.classList.remove('midi-selected');
        });
      }
    });

    document.getElementById('midiDevice').addEventListener('change', e => {
      _setMIDIInput(e.target.value);
    });

    document.getElementById('midiChannel').addEventListener('change', e => {
      _midiChannel = parseInt(e.target.value, 10);
      document.getElementById('midiChannelVal').textContent = 
        _midiChannel === 0 ? 'All' : _midiChannel.toString();
    });

    // Handle keyboard card selection (click anywhere on the card)
    browserHost.addEventListener('click', evt => {
      const card = evt.target.closest('.card[data-card-id]');
      if (card && document.getElementById('midiEnabled').checked) {
        const cardId = parseInt(card.dataset.cardId, 10);
        _selectKeyboard(cardId);
      }
    });

    // Initialize MIDI group state
    document.getElementById('midiGroup').classList.add('disabled-group');
  </script>
</body>
</html>
